<?xml version="1.0" encoding="UTF-8"?>
<SunopsisExport>
<Admin RepositoryVersion="05.02.02.09" IsLegacyIdCompatible="false" />
<Encryption algorithm="AES" keyLength="128" exportKeyHash="" keyVect="p9hcTYDsjU4tNp2RhNhpBg==" exportKeySalt="841a981b-274c-400f-9e30-d7d5a2f58b1f" containsCipherText="false"/>
<Object class="com.sunopsis.dwg.dbobj.SnpTrt">
		<Field name="CleanupOnError" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="CompType" type="java.lang.String">null</Field>
	<Field name="DelegateClass" type="java.lang.String">null</Field>
	<Field name="DelegateScript" type="java.lang.String">null</Field>
	<Field name="ExpectedAstClass" type="java.lang.String">null</Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[63ad64fd-8688-4e6d-a3a4-b91ae88dd74f]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="IndExcludeExUnitBegin" type="java.lang.String">null</Field>
	<Field name="IndExcludeExUnitEnd" type="java.lang.String">null</Field>
	<Field name="IndExcludeExUnitMain" type="java.lang.String">null</Field>
	<Field name="IndExcludeMapBegin" type="java.lang.String">null</Field>
	<Field name="IndExcludeMapCleanup" type="java.lang.String">null</Field>
	<Field name="IndExcludeMapEnd" type="java.lang.String">null</Field>
	<Field name="IndGenerateLoad" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndIsHidden" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndJrnMethod" type="java.lang.String"><![CDATA[S]]></Field>
	<Field name="IndSuppSetBased" type="java.lang.String">null</Field>
	<Field name="IntgType" type="java.lang.String">null</Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="IsConcurrent" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IsSeeded" type="java.lang.String">null</Field>
	<Field name="IBaseCompKm" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IFolder" type="com.sunopsis.sql.DbInt"><![CDATA[294]]></Field>
	<Field name="IProject" type="com.sunopsis.sql.DbInt"><![CDATA[112]]></Field>
	<Field name="IScBaseTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScOrigTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1548]]></Field>
	<Field name="ITxtDelTxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtTrtTxt" type="com.sunopsis.sql.DbInt"><![CDATA[19762]]></Field>
	<Field name="KimMultiDserver" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KmDefault" type="java.lang.String">null</Field>
	<Field name="KmLang" type="java.lang.String">null</Field>
	<Field name="KmSrcLang" type="java.lang.String">null</Field>
	<Field name="KmSrcTechno" type="java.lang.String">null</Field>
	<Field name="KmTechno" type="java.lang.String">null</Field>
	<Field name="KmVersion" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="LkmType" type="java.lang.String">null</Field>
	<Field name="LChecksum" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LCode" type="java.lang.String">null</Field>
	<Field name="OggJkm" type="java.lang.String">null</Field>
	<Field name="OrdFolder" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ProcType" type="java.lang.String">null</Field>
	<Field name="ProdAstType" type="java.lang.String">null</Field>
	<Field name="RepGuid" type="java.lang.String">null</Field>
	<Field name="RepVersion" type="java.lang.String">null</Field>
	<Field name="ScriptPath" type="java.lang.String">null</Field>
	<Field name="ScOrigTrtTag" type="java.lang.String">null</Field>
	<Field name="Subtype" type="java.lang.String">null</Field>
	<Field name="TrtName" type="java.lang.String"><![CDATA[PR_0772_ACTUALIZA_DIM_PLANES]]></Field>
	<Field name="TrtType" type="java.lang.String"><![CDATA[U]]></Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
	<Field name="VLastDate" type="java.sql.Timestamp">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[354518a6-01d2-412b-bb6a-08848a2ae683]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19762]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[107]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[Fecha modificación:  2022-07-01
Modificado por: Factor IT, Oscar de Dios 
Cambio : EPIC - 5151
Objetivo del cambio: Se actualiza el procedimiento agregando la tarea 18 ACTUALIZAR_CAMPOS_CUOTA3 para agregar las columnas DES_CONSU_ADI_DATOS, COD_PERIODO_TIEMPO

Fecha modificación:  2021-04-20
Modificado por: SQDM, Jonathan Castiblanco
Cambio : EPIC - 08515
Objetivo del cambio: Se actualiza el procedimiento para agregar la inserción de la bandera de sim unica

Fecha modificación:  2019-09-03
Modificado por: Procalidad S.A, Jonathan Castiblanco
Cambio : EPIC - 2134
Objetivo del cambio:Se modifican las tareas 08_ACTUALIZAR_CAMPOS_TIPO_2, 09_INSERTAR_NUEVOS_REGISTROS y 11_INSERTAR_NUEVOS_REGISTROS_2, para incluir el procesamiento de los campos tipo 2, CANT_MIN_INC_LDI_1, CANT_MIN_INC_LDI_2, CANT_MIN_INC_LDI_RM y VAL_ADIC_KB en la dimensión TBL_DIM_PLANES_T2,e insertar en el procedimiento de cargue dim planes la BAN_APLICA_AEPA en cero.


Fecha creación:  2019-07-07
Creado por: Procalidad S.A., Joan Vasquez
ID 460
Objetivo del nodo: Procedimiento que actualiza la dimensión de planes a partir de la información cargada.]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpOrigTxt">
		<Field name="GlobalId" type="java.lang.String">null</Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[107]]></Field>
	<Field name="OrigineName" type="java.lang.String"><![CDATA[Edit Command]]></Field>
	<Field name="SnpsCol" type="java.lang.String"><![CDATA[I_TXT_TRT_TXT]]></Field>
	<Field name="SnpsTable" type="java.lang.String"><![CDATA[SNP_TRT]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19763]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[YB_DB_DWH_STAGE_CLIENTES]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c4f4ab4b-e710-42a6-8847-815c340b7887]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4982]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1548]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[30]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[03_ACTUALIZAR_TIPO_FACTURACION_PRE]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[44d7a3f2-6107-4847-8f19-12abddef96f4]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19763]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[UPDATE <%=odiRef.getObjectName("TBL_CLIEN_PLANES")%>
  SET TIPO_FACTURACION = 'MINUTOS'
WHERE TIPO_FACTURACION = 'Sin Tipo' AND
PRODUCTO = 'Prepago']]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpOrigTxt">
		<Field name="GlobalId" type="java.lang.String">null</Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="OrigineName" type="java.lang.String"><![CDATA[Target Technology]]></Field>
	<Field name="SnpsCol" type="java.lang.String"><![CDATA[DEF_I_TXT]]></Field>
	<Field name="SnpsTable" type="java.lang.String"><![CDATA[SNP_LINE_TRT]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19764]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[YB_DB_DWH_STAGE_CLIENTES]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[a45eb1c5-17c1-41b0-9be2-b1567df576cc]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4983]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1548]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[02_ACTUALIZAR_TIPO_FACTURACION_POS]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[f454ad6b-3f1d-491d-ab3e-11f2480ddbc1]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19764]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[UPDATE <%=odiRef.getObjectName("TBL_CLIEN_PLANES")%> T1
SET
  TIPO_FACTURACION = 'SEGUNDOS'
FROM (
  SELECT
    A.SPCODE,
    A.TMCODE,
    COUNT(1)
  FROM
    <%=odiRef.getObjectName("TBL_CLIEN_PLANES")%> A
  INNER JOIN <%=odiRef.getObjectName("TBL_TMP_CLIEN_VOZ_ITEL")%> B
  ON (A.TMCODE = NVL(B.TMCODE,'-1') AND A.SPCODE = NVL(B.SPCODE,'-1'))
  GROUP BY A.TMCODE, A.SPCODE ) S
WHERE PRODUCTO ='Prepago' AND
T1.TMCODE = NVL(S.TMCODE,'-1') AND
T1.SPCODE = NVL(S.SPCODE,'-1')]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19765]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[YB_DB_DWH_STAGE_CLIENTES]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[5a0171ce-4f07-4266-8276-6caceaa0cbea]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4984]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1548]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[01_SET_CATALOG]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d95c2a34-077b-47ff-854f-c77cf2c9d109]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19765]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[--SET CATALOG <%=odiRef.getInfo("DEST_CATALOG")%>]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19766]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[YB_DWH_DB_CLIENTES]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[a45af188-9d17-492a-8cac-3e0f3249b1ae]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4985]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1548]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[50]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[05_ACTUALIZAR_CATEGORIA_DATOS]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[4ac22db6-829f-4358-ad9c-86a691764113]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19766]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[UPDATE <%=odiRef.getObjectName("TBL_DIM_PLANES_T2")%>
  SET CATEGORIA = 'DATOS'
WHERE CATEGORIA IS NULL AND
UPPER(PAQUETE_DESC) LIKE '%DATOS%']]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[YB_DB_DWH_STAGE_CLIENTES]]></Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19767]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[YB_DWH_DB_CLIENTES]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[242a9fc5-8efd-4969-bf75-17a8307e0bc9]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4986]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1548]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[130]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[12_CREAR_TEMPORAL_FAMILIA]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[60575457-00b9-498d-b96b-62f2bcec4244]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19767]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[-- Crear temporal familia de planes 
CREATE TEMPORARY TABLE TBL_TMP_CLIEN_DIM_PLANES_FAMILIA AS (
SELECT
  A.SK_PLANES,
  A.COD_PLAN,
  NVL(B.BAN_PYME,'N') AS BAN_PYME,
  NVL(C.TECNOLOGIA,'Na') AS TECNOLOGIA,
  NVL(C.FAMILIA_PLAN,'Sin Familia Plan') AS FAMILIA_PLAN,
  NVL(D.INDICADOR_PLAN,'Sin Indicador') AS INDICADOR_PLAN,
  NVL(E.REVENTA_INDICADOR,'N') AS  BAN_REVENTA
FROM
  <%=odiRef.getObjectName("TBL_DIM_PLANES_T2")%> A
LEFT JOIN
  <%=odiRef.getInfo("SRC_CATALOG")%>.<%=odiRef.getInfo("SRC_SCHEMA")%>.TBL_CLIEN_PLANES B
ON A.COD_PLAN = B.COD_PLAN
LEFT JOIN
  TBL_TMP_CLIEN_DET_PLAN_FIN C
ON (A.TMCODE = C.TMCODE AND A.SPCODE = C.SPCODE)
LEFT JOIN
  <%=odiRef.getInfo("SRC_CATALOG")%>.<%=odiRef.getInfo("SRC_SCHEMA")%>.TBL_TMP_CLIEN_REVENTA_INDICADOR D
ON (A.TMCODE = D.TMCODE AND TRIM(UPPER(D.REVENTA_INDICADOR)) = 'INDICADOR')
LEFT JOIN
  <%=odiRef.getInfo("SRC_CATALOG")%>.<%=odiRef.getInfo("SRC_SCHEMA")%>.TBL_TMP_CLIEN_REVENTA_INDICADOR E
ON (A.TMCODE = E.TMCODE AND TRIM(UPPER(E.REVENTA_INDICADOR)) = 'REVENTA')
) DISTRIBUTE ON (SK_PLANES)]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19768]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[YB_DB_DWH_STAGE_CLIENTES]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[603c9a34-0590-4098-a48c-715388d221eb]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4987]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1548]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[40]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[04_SET_CATALOG]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[4ff10547-5a6f-4150-8893-30fae48fa0b1]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19768]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[--SET CATALOG <%=odiRef.getInfo("DEST_CATALOG")%>]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[YB_DB_DWH_STAGE_CLIENTES]]></Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19769]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[YB_DWH_DB_CLIENTES]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[27a5d422-08ab-4ec6-9003-9912ac553866]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4988]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1548]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[90]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[08_ACTUALIZAR_CAMPOS_TIPO_2]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d77e3e95-37c2-4bdf-82eb-b3cca61d5b97]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19769]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[-- UPDATE de los campos de tipo dos 
UPDATE <%=odiRef.getObjectName("TBL_DIM_PLANES_T2")%> A
  SET MC_ACTUA = '2'
 FROM <%=odiRef.getInfo("SRC_CATALOG")%>.<%=odiRef.getInfo("SRC_SCHEMA")%>.TBL_CLIEN_PLANES B
WHERE
  MC_ACTUA = '1' AND
  A.COD_PLAN = B.COD_PLAN AND
  (A.TMCODE <> B.TMCODE OR A.SPCODE <> B.SPCODE OR A.VLR_CFM <> B.VLR_CFM OR A.PRODUCTO <> B.PRODUCTO OR A.CLASE_PLAN <> B.CLASE_PLAN OR A.GRP_SERVICIO <> B.GRP_SERVICIO
  OR A.CANT_MIN_INC_LDI_1 <> B.CANT_MIN_INC_LDI_1 OR A.CANT_MIN_INC_LDI_2 <> B.CANT_MIN_INC_LDI_2 OR A.CANT_MIN_INC_LDI_RM <> B.CANT_MIN_INC_LDI_RM OR NVL(A.VAL_ADIC_KB,0) <> NVL(B.VAL_ADIC_KB,0) 
  OR A.COD_PASE <> B.COD_PASE  )]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[YB_DB_DWH_STAGE_CLIENTES]]></Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19770]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[YB_DWH_DB_CLIENTES]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[252ab810-864c-4283-8e5c-c3528c858241]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4989]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1548]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[100]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[09_INSERTAR_NUEVOS_REGISTROS_1]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[2d1711a6-0919-42c9-8df1-3b5ae6a802ac]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19770]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[-- INSERT de los nuevos registros 
INSERT INTO <%=odiRef.getObjectName("TBL_DIM_PLANES_T2")%>
  ( SK_PLANES
  , COD_PLAN
  , TMCODE
  , PLAN_DESC
  , SPCODE
  , PAQUETE_DESC
  , VLR_CFM
  , ACCGLCODE
  , USGGLCODE
  , CATEGORIA
  , PRODUCTO
  , FECHA_INGRESO
  , CLASE_PLAN
  , SEGM_CFM
  , FLAG_PRIM_EVENTO
  , FLAG_PRIM_CARGA
  , CATEGORIA_PREPAGO
  , GRP_SERVICIO
  , FLAG_SEG_CARGA
  , FLAG_ACT_MANUAL
  , FLAG_CLASE_ESP_ESCALERA
  , FLAG_ELEG5MIN
  , FLAG_VOLUMEN_ELEG
  , GRUPO_PRODUCTO
  , FLAG_PLANCONELEG
  , CATEGORIA_ESCALERA
  , CATEGORIA_PRESUPUESTO
  , PLANTYPEID
  , PLANTYPEID_DESC
  , PRODUCTO_GAI
  , ESPECIAL_GAI
  , DOLARES_GAI
  , MIN_INC_C_F_O
  , MIN_INC_C
  , MIN_INC_F
  , MIN_INC_O
  , TIPO_BOLSA
  , GRUPO_AUX1
  , TIPO_PLAN_MINACTIVO
  , MICROCELDA
  , CATE_PLAN_MINACTIVO
  , CALL_TICKET_CONF_ALL
  , CONFIRMATION_TICKET_ALL_WB
  , CONFIDENC_SERVICIOS_DATOS_ALL
  , UPD_LLS_A_OTRO
  , TIPO_FACTURACION
  , TIPO_CONTROL_MAGUARE
  , TIPO_PLAN
  , MC_ACTUA
  , FE_INI_VIG
  , FE_FIN_VIG
  , FE_CARGA_DWH
  , FE_ACTUALIZACION_DWH
  , VLR_CFM_VOZ
  , VLR_CFM_DATOS
  , VLR_CFM_DATOS_IMP
  , CANT_MIN_INC_ELEG_TD
  , CANT_SMS_CLARO_INC
  , CANT_MB_INC_PLAN
  , CANT_MB_BB_INC_PLAN
  , SEGMENTO_PLAN
  , NAVEGACION_PLAN
  , VLR_MIN_INC_CLARO
  , VLR_MIN_INC_FIJOS
  , VLR_MIN_INC_OTROS
  , CANT_ELEG_TD
  , NOMBRE_CUOTA_PCRF
  , TIPO_NAVEGACION_PCRF
  , TIPO_PLAN_PCRF
  , ROUTING_CATEGORY_BCSC
  , TECNOLOGIA
  , FAMILIA_PLAN
  , CATEGORIA_PLAN
  , INDICADOR_PLAN
  , BAN_REVENTA
  , BAN_PYME
  , TIPO_OFERTA
  , BAN_CONVERTIBLE_LDI
  , PSB_MINU_CONV_LDI
  , PSB_VALOR_CONV_LDI
  , PSB_VALOR_CONV_PREFERE_LDI
  , PSB_MINU_CONV_ZONA_LDI
  , PSB_VALOR_CONV_ZONA_LDI
  , PSB_MINU_CONV_PREFERE_LDI
  , PLAN_DESC_COMPLETA
  , VAL_IVA_SERV_VOZ
  , VAL_IVA_SERV_DATOS
  , VAL_IVA_SERV_DATOS_IMP
  , VAL_IVA_SMS
  , VAL_MIN_ADIC_FIJOS
  , VAL_MIN_ADIC_CLARO  
  , VAL_MIN_ADIC_OTROS
  , VAL_SMS_ADIC_CLARO
  , VAL_CANT_ELEG_OFFNET
  , VAL_CANT_ELEG_ONNET
  , VAL_CANT_ELEG_FIJOS
  , BAN_PLAN_MEGASIM
  , VAL_RECARGA_INI_MEGASIM
  , BAN_PLAN_SIM_UNICA
  , CANT_MIN_INC_LDI_1
  , CANT_MIN_INC_LDI_2
  , CANT_MIN_INC_LDI_RM
  , VAL_ADIC_KB
  , COD_PASE 
  )
  SELECT
    ROW_NUMBER() OVER(ORDER BY B.SK_PLANES) + B.MAXSKEY AS SK_PLANES
    , B.COD_PLAN
    , NVL(B.TMCODE,'-1')
    , NVL(B.PLAN_DESC,'Sin Plan CRM')
    , NVL(B.SPCODE,'-1')
    , NVL(B.PAQUETE_DESC,'Sin Paquete de Descuento')
    , NVL(B.VLR_CFM,0)
    , NVL(B.ACCGLCODE,'Sin Código')
    , NVL(B.USGGLCODE,'Sin Código')
    , B.CATEGORIA
    , NVL(B.PRODUCTO,'Sin Producto')
    , NVL(B.FECHA_INGRESO,'1900-01-01 00:00:00')
    , B.CLASE_PLAN
    , NVL(B.SEGM_CFM,'0')
    , B.FLAG_PRIM_EVENTO
    , B.FLAG_PRIM_CARGA
    , B.CATEGORIA_PREPAGO
    , NVL(B.GRP_SERVICIO,'Sin Grupo')
    , B.FLAG_SEG_CARGA
    , B.FLAG_ACT_MANUAL
    , B.FLAG_CLASE_ESP_ESCALERA
    , B.FLAG_ELEG5MIN
    , B.FLAG_VOLUMEN_ELEG
    , B.GRUPO_PRODUCTO
    , B.FLAG_PLANCONELEG
    , B.CATEGORIA_ESCALERA
    , B.CATEGORIA_PRESUPUESTO
    , B.PLANTYPEID
    , B.PLANTYPEID_DESC
    , B.PRODUCTO_GAI
    , B.ESPECIAL_GAI
    , B.DOLARES_GAI
    , B.MIN_INC_C_F_O
    , B.MIN_INC_C
    , B.MIN_INC_F
    , B.MIN_INC_O
    , B.TIPO_BOLSA
    , B.GRUPO_AUX1
    , NVL(B.TIPO_PLAN_MINACTIVO,'-1')
    , NVL(B.MICROCELDA,'Sin Microcelda')
    , NVL(B.CATE_PLAN_MINACTIVO,'Sin Plan')
    , B.CALL_TICKET_CONF_ALL
    , B.CONFIRMATION_TICKET_ALL_WB
    , B.CONFIDENC_SERVICIOS_DATOS_ALL
    , B.UPD_LLS_A_OTRO
    , NVL(B.TIPO_FACTURACION,'Sin Tipo')
    , NVL(B.TIPO_CONTROL_MAGUARE,'Sin Tipo Control')
    , NVL(B.TIPO_PLAN,'Sin Tipo')
    , 1 MC_ACTUA
    , DATE_TRUNC('DAY',CURRENT_TIMESTAMP) FE_INI_VIG
    , '2099-12-31 23:59:59' FE_FIN_VIG
    , CURRENT_TIMESTAMP FE_CARGA_DWH
    , CURRENT_TIMESTAMP FE_ACTUALIZACION_DWH
    , B.VLR_CFM_VOZ
    , B.VLR_CFM_DATOS
    , B.VLR_CFM_DATOS_IMP
    , B.CANT_MIN_INC_ELEG_TD
    , B.CANT_SMS_CLARO_INC
    , B.CANT_MB_INC_PLAN
    , B.CANT_MB_BB_INC_PLAN
    , B.SEGMENTO_PLAN
    , B.NAVEGACION_PLAN
    , B.VLR_MIN_INC_CLARO
    , B.VLR_MIN_INC_FIJOS
    , B.VLR_MIN_INC_OTROS
    , B.CANT_ELEG_TD
    , B.NOMBRE_CUOTA_PCRF
    , B.TIPO_NAVEGACION_PCRF
    , B.TIPO_PLAN_PCRF
    , B.ROUTING_CATEGORY_BCSC
    , B.TECNOLOGIA
    , B.FAMILIA_PLAN
    , B.CATEGORIA_PLAN
    , B.INDICADOR_PLAN
    , B.BAN_REVENTA
    , B.BAN_PYME
    , B.TIPO_OFERTA
    , B.BAN_CONVERTIBLE_LDI
    , B.PSB_MINU_CONV_LDI
    , B.PSB_VALOR_CONV_LDI
    , B.PSB_VALOR_CONV_PREFERE_LDI
    , B.PSB_MINU_CONV_ZONA_LDI
    , B.PSB_VALOR_CONV_ZONA_LDI
    , B.PSB_MINU_CONV_PREFERE_LDI
    , NVL(B.PLAN_DESC_COMPLETA,'Sin descripción')
    , B.VAL_IVA_SERV_VOZ
    , B.VAL_IVA_SERV_DATOS
    , B.VAL_IVA_SERV_DATOS_IMP
    , B.VAL_IVA_SMS
    , B.VAL_MIN_ADIC_FIJOS
    , B.VAL_MIN_ADIC_CLARO    
    , B.VAL_MIN_ADIC_OTROS
    , B.VAL_SMS_ADIC_CLARO
    , B.VAL_CANT_ELEG_OFFNET
    , B.VAL_CANT_ELEG_ONNET
    , B.VAL_CANT_ELEG_FIJOS
    , B.BAN_PLAN_MEGASIM
    , B.VAL_RECARGA_INI_MEGASIM 
    , CASE WHEN B.cod_plan IN ('#PRY_DWH.v_0772_plan_sim_unica') THEN 1  ELSE 0 END BAN_PLAN_SIM_UNICA
    , B.CANT_MIN_INC_LDI_1
    , B.CANT_MIN_INC_LDI_2
    , B.CANT_MIN_INC_LDI_RM
    , B.VAL_ADIC_KB
    , B.COD_PASE 
  FROM
  (
    SELECT
      *
    FROM
    (
      SELECT A.*,
        B.SK_PLANES,
        B.MC_ACTUA,
        B.FE_INI_VIG,
        B.FE_FIN_VIG,
        B.FE_CARGA_DWH,
        B.FE_ACTUALIZACION_DWH
      FROM <%=odiRef.getInfo("SRC_CATALOG")%>.<%=odiRef.getInfo("SRC_SCHEMA")%>.TBL_CLIEN_PLANES A
      INNER JOIN
        <%=odiRef.getObjectName("TBL_DIM_PLANES_T2")%> B
      ON(A.COD_PLAN = B.COD_PLAN)
      WHERE A.TMCODE <> B.TMCODE OR A.SPCODE <> B.SPCODE OR A.VLR_CFM <> B.VLR_CFM OR A.PRODUCTO <> B.PRODUCTO
      OR A.CLASE_PLAN <> B.CLASE_PLAN OR A.GRP_SERVICIO <> B.GRP_SERVICIO
      OR A.CANT_MIN_INC_LDI_1 <> B.CANT_MIN_INC_LDI_1 OR A.CANT_MIN_INC_LDI_2 <> B.CANT_MIN_INC_LDI_2 OR A.CANT_MIN_INC_LDI_RM <> B.CANT_MIN_INC_LDI_RM
      OR NVL(A.VAL_ADIC_KB,0) <> NVL(B.VAL_ADIC_KB,0)
      OR A.COD_PASE <> B.COD_PASE  
    ) A
    CROSS JOIN
    (
      SELECT NVL(MAX(SK_PLANES), 0) MAXSKEY
      FROM <%=odiRef.getObjectName("TBL_DIM_PLANES_T2")%>
    ) B
  ) B
  WHERE MC_ACTUA = '2']]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[YB_DB_DWH_STAGE_CLIENTES]]></Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19771]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[YB_DWH_DB_CLIENTES]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[f372992e-59db-4d32-be16-2480de3236d2]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4990]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1548]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[110]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[10_ACTUALIZAR_VIGENCIAS]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[bac863d2-d112-4d0d-9afe-2dc3b517b26f]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19771]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[-- UPDATE de las vigencias 
UPDATE <%=odiRef.getObjectName("TBL_DIM_PLANES_T2")%> SET
  MC_ACTUA = '0'
  , FE_FIN_VIG = (
  SELECT DISTINCT
    CAST( (SUBSTRING(CAST( CURRENT_TIMESTAMP - CAST('1 days' AS INTERVAL) AS CHAR(25)), 1, 10) || ' 23:59:59') AS TIMESTAMP ) FE_FIN_VIG
  FROM <%=odiRef.getObjectName("TBL_DIM_PLANES_T2")%>
  WHERE MC_ACTUA = '2')
WHERE MC_ACTUA = '2']]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[YB_DB_DWH_STAGE_CLIENTES]]></Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19772]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[YB_DWH_DB_CLIENTES]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[30a57f46-d5f7-49ff-9259-9da9513f08ad]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4991]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1548]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[120]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[11_INSERTAR_NUEVOS_REGISTROS_2]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[31d85e9f-6c8d-43ea-bc06-e5834993d1f0]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19772]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[-- INSERT de nuevos registros 
INSERT INTO <%=odiRef.getObjectName("TBL_DIM_PLANES_T2")%>
  ( SK_PLANES
  , COD_PLAN
  , TMCODE
  , PLAN_DESC
  , SPCODE
  , PAQUETE_DESC
  , VLR_CFM
  , ACCGLCODE
  , USGGLCODE
  , CATEGORIA
  , PRODUCTO
  , FECHA_INGRESO
  , CLASE_PLAN
  , SEGM_CFM
  , FLAG_PRIM_EVENTO
  , FLAG_PRIM_CARGA
  , CATEGORIA_PREPAGO
  , GRP_SERVICIO
  , FLAG_SEG_CARGA
  , FLAG_ACT_MANUAL
  , FLAG_CLASE_ESP_ESCALERA
  , FLAG_ELEG5MIN
  , FLAG_VOLUMEN_ELEG
  , GRUPO_PRODUCTO
  , FLAG_PLANCONELEG
  , CATEGORIA_ESCALERA
  , CATEGORIA_PRESUPUESTO
  , PLANTYPEID
  , PLANTYPEID_DESC
  , PRODUCTO_GAI
  , ESPECIAL_GAI
  , DOLARES_GAI
  , MIN_INC_C_F_O
  , MIN_INC_C
  , MIN_INC_F
  , MIN_INC_O
  , TIPO_BOLSA
  , GRUPO_AUX1
  , TIPO_PLAN_MINACTIVO
  , MICROCELDA
  , CATE_PLAN_MINACTIVO
  , CALL_TICKET_CONF_ALL
  , CONFIRMATION_TICKET_ALL_WB
  , CONFIDENC_SERVICIOS_DATOS_ALL
  , UPD_LLS_A_OTRO
  , TIPO_FACTURACION
  , TIPO_CONTROL_MAGUARE
  , TIPO_PLAN
  , MC_ACTUA
  , FE_INI_VIG
  , FE_FIN_VIG
  , FE_CARGA_DWH
  , FE_ACTUALIZACION_DWH
  , VLR_CFM_VOZ
  , VLR_CFM_DATOS
  , VLR_CFM_DATOS_IMP
  , CANT_MIN_INC_ELEG_TD
  , CANT_SMS_CLARO_INC
  , CANT_MB_INC_PLAN
  , CANT_MB_BB_INC_PLAN
  , SEGMENTO_PLAN
  , NAVEGACION_PLAN
  , VLR_MIN_INC_CLARO
  , VLR_MIN_INC_FIJOS
  , VLR_MIN_INC_OTROS
  , CANT_ELEG_TD
  , NOMBRE_CUOTA_PCRF
  , TIPO_NAVEGACION_PCRF
  , TIPO_PLAN_PCRF
  , ROUTING_CATEGORY_BCSC
  , TECNOLOGIA
  , FAMILIA_PLAN
  , CATEGORIA_PLAN
  , INDICADOR_PLAN
  , BAN_REVENTA
  , BAN_PYME
  , TIPO_OFERTA
  , BAN_CONVERTIBLE_LDI
  , PSB_MINU_CONV_LDI
  , PSB_VALOR_CONV_LDI
  , PSB_VALOR_CONV_PREFERE_LDI
  , PSB_MINU_CONV_ZONA_LDI
  , PSB_VALOR_CONV_ZONA_LDI
  , PSB_MINU_CONV_PREFERE_LDI
  , PLAN_DESC_COMPLETA
  , VAL_IVA_SERV_VOZ
  , VAL_IVA_SERV_DATOS
  , VAL_IVA_SERV_DATOS_IMP
  , VAL_IVA_SMS
  , VAL_MIN_ADIC_FIJOS
  , VAL_MIN_ADIC_CLARO  
  , VAL_MIN_ADIC_OTROS
  , VAL_SMS_ADIC_CLARO
  , VAL_CANT_ELEG_OFFNET
  , VAL_CANT_ELEG_ONNET
  , VAL_CANT_ELEG_FIJOS
  , BAN_PLAN_MEGASIM
  , VAL_RECARGA_INI_MEGASIM
  , BAN_PLAN_SIM_UNICA
  , CANT_MIN_INC_LDI_1
  , CANT_MIN_INC_LDI_2
  , CANT_MIN_INC_LDI_RM
  , VAL_ADIC_KB
  , COD_PASE 
  )
  SELECT
    ROW_NUMBER() OVER(ORDER BY B.SK_PLANES) + B.MAXSKEY AS SK_PLANES
    , B.COD_PLAN
    , NVL(B.TMCODE,'-1')
    , NVL(B.PLAN_DESC,'Sin Plan CRM')
    , NVL(B.SPCODE,'-1')
    , NVL(B.PAQUETE_DESC,'Sin Paquete de Descuento')
    , NVL(B.VLR_CFM,0)
    , NVL(B.ACCGLCODE,'Sin Código')
    , NVL(B.USGGLCODE,'Sin Código')
    , B.CATEGORIA
    , NVL(B.PRODUCTO,'Sin Producto')
    , NVL(B.FECHA_INGRESO,'1900-01-01 00:00:00')
    , B.CLASE_PLAN
    , NVL(B.SEGM_CFM,'0')
    , B.FLAG_PRIM_EVENTO
    , B.FLAG_PRIM_CARGA
    , B.CATEGORIA_PREPAGO
    , NVL(B.GRP_SERVICIO,'Sin Grupo')
    , B.FLAG_SEG_CARGA
    , B.FLAG_ACT_MANUAL
    , B.FLAG_CLASE_ESP_ESCALERA
    , B.FLAG_ELEG5MIN
    , B.FLAG_VOLUMEN_ELEG
    , B.GRUPO_PRODUCTO
    , B.FLAG_PLANCONELEG
    , B.CATEGORIA_ESCALERA
    , B.CATEGORIA_PRESUPUESTO
    , B.PLANTYPEID
    , B.PLANTYPEID_DESC
    , B.PRODUCTO_GAI
    , B.ESPECIAL_GAI
    , B.DOLARES_GAI
    , B.MIN_INC_C_F_O
    , B.MIN_INC_C
    , B.MIN_INC_F
    , B.MIN_INC_O
    , B.TIPO_BOLSA
    , B.GRUPO_AUX1
    , NVL(B.TIPO_PLAN_MINACTIVO,'-1')
    , NVL(B.MICROCELDA,'Sin Microcelda')
    , NVL(B.CATE_PLAN_MINACTIVO,'Sin Plan')
    , B.CALL_TICKET_CONF_ALL
    , B.CONFIRMATION_TICKET_ALL_WB
    , B.CONFIDENC_SERVICIOS_DATOS_ALL
    , B.UPD_LLS_A_OTRO
    , NVL(B.TIPO_FACTURACION,'Sin Tipo')
    , NVL(B.TIPO_CONTROL_MAGUARE,'Sin Tipo Control')
    , NVL(B.TIPO_PLAN,'Sin Tipo')
    , 1 MC_ACTUA
    , DATE_TRUNC('DAY',CURRENT_TIMESTAMP) FE_INI_VIG
    , '2099-12-31 23:59:59' FE_FIN_VIG
    , CURRENT_TIMESTAMP FE_CARGA_DWH
    , CURRENT_TIMESTAMP FE_ACTUALIZACION_DWH
    , B.VLR_CFM_VOZ
    , B.VLR_CFM_DATOS
    , B.VLR_CFM_DATOS_IMP
    , B.CANT_MIN_INC_ELEG_TD
    , B.CANT_SMS_CLARO_INC
    , B.CANT_MB_INC_PLAN
    , B.CANT_MB_BB_INC_PLAN
    , B.SEGMENTO_PLAN
    , B.NAVEGACION_PLAN
    , B.VLR_MIN_INC_CLARO
    , B.VLR_MIN_INC_FIJOS
    , B.VLR_MIN_INC_OTROS
    , B.CANT_ELEG_TD
    , B.NOMBRE_CUOTA_PCRF
    , B.TIPO_NAVEGACION_PCRF
    , B.TIPO_PLAN_PCRF
    , B.ROUTING_CATEGORY_BCSC
    , B.TECNOLOGIA
    , B.FAMILIA_PLAN
    , B.CATEGORIA_PLAN
    , B.INDICADOR_PLAN
    , B.BAN_REVENTA
    , B.BAN_PYME
    , B.TIPO_OFERTA
    , B.BAN_CONVERTIBLE_LDI
    , B.PSB_MINU_CONV_LDI
    , B.PSB_VALOR_CONV_LDI
    , B.PSB_VALOR_CONV_PREFERE_LDI
    , B.PSB_MINU_CONV_ZONA_LDI
    , B.PSB_VALOR_CONV_ZONA_LDI
    , B.PSB_MINU_CONV_PREFERE_LDI
    , NVL(B.PLAN_DESC_COMPLETA,'Sin descripción')
    , B.VAL_IVA_SERV_VOZ
    , B.VAL_IVA_SERV_DATOS
    , B.VAL_IVA_SERV_DATOS_IMP
    , B.VAL_IVA_SMS
    , B.VAL_MIN_ADIC_FIJOS
    , B.VAL_MIN_ADIC_CLARO    
    , B.VAL_MIN_ADIC_OTROS
    , B.VAL_SMS_ADIC_CLARO
    , B.VAL_CANT_ELEG_OFFNET
    , B.VAL_CANT_ELEG_ONNET
    , B.VAL_CANT_ELEG_FIJOS
    , null AS BAN_PLAN_MEGASIM
    , null AS VAL_RECARGA_INI_MEGASIM
    , CASE WHEN cod_plan IN ('#PRY_DWH.v_0772_plan_sim_unica') THEN 1  ELSE 0 END BAN_PLAN_SIM_UNICA
    , B.CANT_MIN_INC_LDI_1
    , B.CANT_MIN_INC_LDI_2
    , B.CANT_MIN_INC_LDI_RM
    , B.VAL_ADIC_KB
    , B.COD_PASE 
  FROM
  (
    SELECT
      *
    FROM
    (
      SELECT A.*,
        B.SK_PLANES,
        B.MC_ACTUA,
        B.FE_INI_VIG,
        B.FE_FIN_VIG,
        B.FE_CARGA_DWH,
        B.FE_ACTUALIZACION_DWH
      FROM <%=odiRef.getInfo("SRC_CATALOG")%>.<%=odiRef.getInfo("SRC_SCHEMA")%>.TBL_CLIEN_PLANES A
      LEFT JOIN
        <%=odiRef.getObjectName("TBL_DIM_PLANES_T2")%> B
      ON (A.COD_PLAN = B.COD_PLAN)
      WHERE A.COD_PLAN IS NOT NULL AND B.SK_PLANES IS NULL
    ) A
    CROSS JOIN (
    SELECT NVL(MAX(SK_PLANES), 0) MAXSKEY
    FROM <%=odiRef.getObjectName("TBL_DIM_PLANES_T2")%>
    ) B
  ) B]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[YB_DB_DWH_STAGE_CLIENTES]]></Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19773]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[YB_DWH_DB_CLIENTES]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[a37115e4-eee3-4598-ab7e-971e54a1d437]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4992]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1548]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[07_ACTUALIZAR_CAMPOS_TIPO_1]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[005ac9bc-5f22-4496-aec4-4ab571b7e4b6]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19773]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[-- UPDATE de los campos de tipo uno 
UPDATE <%=odiRef.getObjectName("TBL_DIM_PLANES_T2")%> A SET
  PLAN_DESC = NVL(B.PLAN_DESC,'Sin Plan CRM')
  , PLAN_DESC_COMPLETA = NVL(B.PLAN_DESC_COMPLETA,'Sin descripción')
  , PAQUETE_DESC = NVL(B.PAQUETE_DESC,'Sin Paquete de Descuento')
  , ACCGLCODE = NVL(B.ACCGLCODE,'Sin Código')
  , USGGLCODE = NVL(B.USGGLCODE,'Sin Código')
  , FECHA_INGRESO = NVL(B.FECHA_INGRESO,'1900-01-01 00:00:00')
  , SEGM_CFM = NVL(B.SEGM_CFM,'0')
  , TIPO_PLAN_MINACTIVO = NVL(B.TIPO_PLAN_MINACTIVO,'-1')
  , MICROCELDA = NVL(B.MICROCELDA,'Sin Microcelda')
  , CATE_PLAN_MINACTIVO = NVL(B.CATE_PLAN_MINACTIVO,'Sin Plan')
  , TIPO_FACTURACION = NVL(B.TIPO_FACTURACION,'Sin Tipo')
  , TIPO_CONTROL_MAGUARE = NVL(B.TIPO_CONTROL_MAGUARE,'Sin Tipo Control')
  , TIPO_PLAN = NVL(B.TIPO_PLAN,'Sin Tipo')
  , TIPO_BOLSA = NVL(B.TIPO_BOLSA,'Sin Tipo')
  , FE_ACTUALIZACION_DWH = CURRENT_TIMESTAMP
  , VLR_CFM_VOZ = NVL(B.VLR_CFM_VOZ,0)
  , VLR_CFM_DATOS = NVL(B.VLR_CFM_DATOS,0)
  , VLR_CFM_DATOS_IMP = NVL(B.VLR_CFM_DATOS_IMP,0)
  , MIN_INC_C_F_O = NVL(B.MIN_INC_C_F_O,0)
  , MIN_INC_C = NVL(B.MIN_INC_C,0)
  , MIN_INC_F = NVL(B.MIN_INC_F,0)
  , MIN_INC_O = NVL(B.MIN_INC_O,0)
  , CANT_MIN_INC_ELEG_TD = NVL(B.CANT_MIN_INC_ELEG_TD,0)
  , CANT_SMS_CLARO_INC = NVL(B.CANT_SMS_CLARO_INC,0)
  , CANT_MB_INC_PLAN = NVL(B.CANT_MB_INC_PLAN,0)
  , CANT_MB_BB_INC_PLAN = NVL(B.CANT_MB_BB_INC_PLAN,0)
  , SEGMENTO_PLAN = NVL(B.SEGMENTO_PLAN,'Na')
  , NAVEGACION_PLAN = NVL(B.NAVEGACION_PLAN,'Na')
  , VLR_MIN_INC_CLARO = NVL(B.VLR_MIN_INC_CLARO,0)
  , VLR_MIN_INC_FIJOS = NVL(B.VLR_MIN_INC_FIJOS,0)
  , VLR_MIN_INC_OTROS = NVL(B.VLR_MIN_INC_OTROS,0)
  , VAL_MIN_ADIC_CLARO = NVL(B.VAL_MIN_ADIC_CLARO,0)
  , VAL_MIN_ADIC_FIJOS = NVL(B.VAL_MIN_ADIC_FIJOS,0)
  , VAL_MIN_ADIC_OTROS = NVL(B.VAL_MIN_ADIC_OTROS,0)
  , VAL_SMS_ADIC_CLARO = NVL(B.VAL_SMS_ADIC_CLARO,0)
  , VAL_CANT_ELEG_FIJOS = NVL(B.VAL_CANT_ELEG_FIJOS,0)
  , VAL_CANT_ELEG_ONNET = NVL(B.VAL_CANT_ELEG_ONNET,0)
  , VAL_CANT_ELEG_OFFNET = NVL(B.VAL_CANT_ELEG_OFFNET,0)
  , CANT_ELEG_TD = NVL(B.CANT_ELEG_TD,0)
  , NOMBRE_CUOTA_PCRF = NVL(B.NOMBRE_CUOTA_PCRF,'Na')
  , TIPO_NAVEGACION_PCRF = NVL(B.TIPO_NAVEGACION_PCRF,'Na')
  , TIPO_PLAN_PCRF = NVL(B.TIPO_PLAN_PCRF,'Na')
  , ROUTING_CATEGORY_BCSC = NVL(B.ROUTING_CATEGORY_BCSC,0)
  , TIPO_OFERTA = NVL(B.TIPO_OFERTA,'Na')
  , BAN_CONVERTIBLE_LDI = NVL(B.BAN_CONVERTIBLE_LDI,'N')
  , PSB_MINU_CONV_LDI = NVL(B.PSB_MINU_CONV_LDI,0)
  , PSB_VALOR_CONV_LDI = NVL(B.PSB_VALOR_CONV_LDI,0)
  , PSB_VALOR_CONV_PREFERE_LDI = NVL(B.PSB_VALOR_CONV_PREFERE_LDI,0)
  , PSB_MINU_CONV_ZONA_LDI = NVL(B.PSB_MINU_CONV_ZONA_LDI,0)
  , PSB_VALOR_CONV_ZONA_LDI = NVL(B.PSB_VALOR_CONV_ZONA_LDI ,0)
  , PSB_MINU_CONV_PREFERE_LDI = NVL(B.PSB_MINU_CONV_PREFERE_LDI,0)
  , VAL_IVA_SERV_VOZ = CASE WHEN NVL(B.VAL_IVA_SERV_VOZ,0) <> 0 THEN B.VAL_IVA_SERV_VOZ ELSE A.VAL_IVA_SERV_VOZ END
  , VAL_IVA_SERV_DATOS = CASE WHEN NVL(B.VAL_IVA_SERV_DATOS,0) <> 0 THEN B.VAL_IVA_SERV_DATOS ELSE A.VAL_IVA_SERV_DATOS END
  , VAL_IVA_SERV_DATOS_IMP = CASE WHEN NVL(B.VAL_IVA_SERV_DATOS_IMP,0) <> 0 THEN B.VAL_IVA_SERV_DATOS_IMP ELSE A.VAL_IVA_SERV_DATOS_IMP END
  , VAL_IVA_SMS = CASE WHEN NVL(B.VAL_IVA_SMS,0) <> 0 THEN B.VAL_IVA_SMS ELSE A.VAL_IVA_SMS END 
  , COD_PASE = NVL(B.COD_PASE,'NA')    
FROM <%=odiRef.getInfo("SRC_CATALOG")%>.<%=odiRef.getInfo("SRC_SCHEMA")%>.TBL_CLIEN_PLANES B
WHERE
  MC_ACTUA = '1' AND A.COD_PLAN = B.COD_PLAN
  AND ( A.PLAN_DESC <> B.PLAN_DESC OR A.PAQUETE_DESC <> B.PAQUETE_DESC OR A.ACCGLCODE <> B.ACCGLCODE OR A.USGGLCODE <> B.USGGLCODE
  OR A.CATEGORIA <> B.CATEGORIA OR A.FECHA_INGRESO <> B.FECHA_INGRESO OR A.SEGM_CFM <> B.SEGM_CFM OR A.TIPO_PLAN_MINACTIVO <> B.TIPO_PLAN_MINACTIVO
  OR A.MICROCELDA <> B.MICROCELDA OR A.CATE_PLAN_MINACTIVO <> B.CATE_PLAN_MINACTIVO OR A.TIPO_FACTURACION <> B.TIPO_FACTURACION
  OR A.TIPO_CONTROL_MAGUARE <> B.TIPO_CONTROL_MAGUARE OR A.TIPO_PLAN <> B.TIPO_PLAN
  OR A.VLR_CFM_VOZ <> B.VLR_CFM_VOZ OR A.VLR_CFM_DATOS <> B.VLR_CFM_DATOS OR A.VLR_CFM_DATOS_IMP <> B.VLR_CFM_DATOS_IMP
  OR A.CANT_MIN_INC_ELEG_TD <> B.CANT_MIN_INC_ELEG_TD OR A.CANT_SMS_CLARO_INC <> B.CANT_SMS_CLARO_INC
  OR A.CANT_MB_INC_PLAN <> B.CANT_MB_INC_PLAN OR A.CANT_MB_BB_INC_PLAN <> B.CANT_MB_BB_INC_PLAN
  OR A.SEGMENTO_PLAN <> B.SEGMENTO_PLAN OR A.NAVEGACION_PLAN <> B.NAVEGACION_PLAN OR A.VLR_MIN_INC_CLARO <> B.VLR_MIN_INC_CLARO
  OR A.VLR_MIN_INC_FIJOS <> B.VLR_MIN_INC_FIJOS OR A.VLR_MIN_INC_OTROS <> B.VLR_MIN_INC_OTROS OR A.CANT_ELEG_TD <> B.CANT_ELEG_TD
  OR A.NOMBRE_CUOTA_PCRF <> B.NOMBRE_CUOTA_PCRF OR A.TIPO_NAVEGACION_PCRF <> B.TIPO_NAVEGACION_PCRF
  OR A.TIPO_PLAN_PCRF <> B.TIPO_PLAN_PCRF OR A.ROUTING_CATEGORY_BCSC <> B.ROUTING_CATEGORY_BCSC
  OR A.TIPO_OFERTA <> B.TIPO_OFERTA OR A.BAN_CONVERTIBLE_LDI <> B.BAN_CONVERTIBLE_LDI
  OR A.PSB_MINU_CONV_LDI <> B.PSB_MINU_CONV_LDI OR A.PSB_VALOR_CONV_LDI <> B.PSB_VALOR_CONV_LDI
  OR A.PSB_VALOR_CONV_PREFERE_LDI <> B.PSB_VALOR_CONV_PREFERE_LDI OR A.PSB_MINU_CONV_ZONA_LDI <> B.PSB_MINU_CONV_ZONA_LDI
  OR A.PSB_VALOR_CONV_ZONA_LDI <> B.PSB_VALOR_CONV_ZONA_LDI
  OR A.PSB_MINU_CONV_PREFERE_LDI <> B.PSB_MINU_CONV_PREFERE_LDI
  OR A.TIPO_BOLSA <> B.TIPO_BOLSA OR A.PLAN_DESC_COMPLETA <> B.PLAN_DESC_COMPLETA OR A.MIN_INC_C_F_O <> B.MIN_INC_C_F_O
  OR A.MIN_INC_C <> B.MIN_INC_C OR A.MIN_INC_F <> B.MIN_INC_F OR A.MIN_INC_O <> B.MIN_INC_O
  OR A.VAL_CANT_ELEG_FIJOS <> B.VAL_CANT_ELEG_FIJOS OR A.VAL_CANT_ELEG_ONNET <> B.VAL_CANT_ELEG_ONNET
  OR A.VAL_CANT_ELEG_OFFNET <> B.VAL_CANT_ELEG_OFFNET OR A.VAL_MIN_ADIC_CLARO <> B.VAL_MIN_ADIC_CLARO
  OR A.VAL_MIN_ADIC_FIJOS <> B.VAL_MIN_ADIC_FIJOS OR A.VAL_MIN_ADIC_OTROS <> B.VAL_MIN_ADIC_OTROS OR A.VAL_SMS_ADIC_CLARO <> B.VAL_SMS_ADIC_CLARO
  OR A.VAL_IVA_SERV_VOZ <> B.VAL_IVA_SERV_VOZ OR A.VAL_IVA_SERV_DATOS <> B.VAL_IVA_SERV_DATOS
  OR A.VAL_IVA_SERV_DATOS_IMP <> B.VAL_IVA_SERV_DATOS_IMP OR A.VAL_IVA_SMS <> B.VAL_IVA_SMS  OR A.COD_PASE <> B.COD_PASE  
  )]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[YB_DWH_DB_DWH]]></Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19774]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[YB_DWH_DB_CLIENTES]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[6763bdce-c07a-473b-a7ff-302bbd8ba70b]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4993]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1548]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[60]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[06_ACTUALIZAR_CATEGORIA_ESCALERA]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[a8342489-4bad-44bb-abd6-38d98f93fdc1]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19774]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[UPDATE <%=odiRef.getObjectName("TBL_DIM_PLANES_T2")%>
SET FLAG_CLASE_ESP_ESCALERA = 'X'
WHERE COD_PLAN IN (
  SELECT
    TMCYSPC
  FROM <%=odiRef.getInfo("SRC_CATALOG")%>.<%=odiRef.getInfo("SRC_SCHEMA")%>.PLANPROD_BSCS A
  INNER JOIN #PRY_DWH.V_0772_SISNOT_DB_DWH_STAGE.#PRY_DWH.V_0772_SISNOT_SCH_CLIENTES.TBL_CLIEN_PLANES B
  ON (A.TMCYSPC = B.COD_PLAN)
  WHERE A.TIPO = 'Prepago' AND B.PRODUCTO = 'Postpago') OR
  (PRODUCTO = 'Prepago' AND (LOWER(PAQUETE_DESC) LIKE '%demo%' OR
  LOWER(PAQUETE_DESC) LIKE '%ouse%' OR
  LOWER(PAQUETE_DESC) LIKE '%compartel%'))]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[YB_DB_DWH_STAGE_CLIENTES]]></Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19775]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[YB_DWH_DB_CLIENTES]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[cbdad86f-2172-4130-8a67-3a51f4a05fe0]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4994]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1548]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[140]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[13_ACTUALIZAR_CATEGORIA_FAMILIA]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d1fe4423-1980-4faf-8e72-b851b7f706c8]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19775]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[-- Actualizar planes FAMILIA_PLAN
UPDATE <%=odiRef.getObjectName("TBL_DIM_PLANES_T2")%> A
SET
  BAN_PYME = B.BAN_PYME,
  TECNOLOGIA = B.TECNOLOGIA,
  FAMILIA_PLAN = B.FAMILIA_PLAN,
  INDICADOR_PLAN = B.INDICADOR_PLAN,
  BAN_REVENTA = B.BAN_REVENTA,
  FE_ACTUALIZACION_DWH = NOW()
FROM TBL_TMP_CLIEN_DIM_PLANES_FAMILIA B
  WHERE A.SK_PLANES = B.SK_PLANES AND (
    NVL(A.BAN_PYME,'') <> B.BAN_PYME OR
    NVL(A.TECNOLOGIA,'') <> B.TECNOLOGIA OR
    NVL(A.FAMILIA_PLAN,'') <> B.FAMILIA_PLAN OR
    NVL(A.INDICADOR_PLAN,'') <> B.INDICADOR_PLAN OR
    NVL(A.BAN_REVENTA,'') <> B.BAN_REVENTA
  )]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[YB_DB_DWH_STAGE_CLIENTES]]></Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19776]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[YB_DWH_DB_CLIENTES]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[19247e69-1b4f-4b4e-90be-af86437581fc]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4995]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1548]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[150]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[14_ACTUALIZAR_CATEGORIA_PLAN]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[404c90b4-4cdb-40c4-a639-eda29097e4ae]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19776]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[-- Actualizar CATEGORIA_PLAN 
UPDATE <%=odiRef.getObjectName("TBL_DIM_PLANES_T2")%> T1 
SET
  CATEGORIA_PLAN = (
    CASE WHEN (UPPER(T1.PRODUCTO) = 'POSTPAGO') THEN
      (CASE WHEN (T2.TECNOLOGIA = 'Blackberry') THEN 'BB'
            WHEN ((T2.FAMILIA_PLAN = 'Empresarial') AND (T2.Tipo_Plan = 'Voz')) THEN 'EMPRESARIAL'
            WHEN (T2.TECNOLOGIA = 'Internet movil') THEN 'INTERNET'
            WHEN (T2.TECNOLOGIA = 'Iphone') THEN 'IPHONE'
            WHEN ((T2.FAMILIA_PLAN = 'Masivo') AND (T2.Tipo_Plan = 'Voz')) THEN 'MASIVO'
            WHEN (T2.TECNOLOGIA = 'Smartphone') THEN 'OTROS SMARTPHONE'
            WHEN (T2.TECNOLOGIA = 'Transaccionales') THEN 'Transaccionales'
            WHEN (T2.TECNOLOGIA = 'IoT') THEN 'IoT'
            ELSE 'Sin Categoria Asignada' END)
         WHEN (UPPER(T1.PRODUCTO)='PREPAGO') THEN
      (CASE WHEN (T2.TECNOLOGIA = 'Sim Card') THEN 'CHIP CLARO'
            WHEN (T2.TECNOLOGIA = 'Kit') THEN 'KIT'
            WHEN (T2.TECNOLOGIA = 'Chip Costa') THEN 'WB EST CHIP COSTA'
            WHEN (T2.TECNOLOGIA = 'Estrategico') THEN 'WB ESTRATEGICO'
            WHEN (T2.TECNOLOGIA = 'Portabilidad') THEN 'WB POR SEGUNDOS'
            WHEN (T2.TECNOLOGIA = 'Tactico') THEN 'WB TACTICO'
            ELSE 'Sin Categoria Asignada' END)
         ELSE 'Sin Categoria Asignada' END)
FROM TBL_TMP_CLIEN_DET_PLAN_FIN T2
WHERE T1.TMCODE = T2.TMCODE AND T1.SPCODE = T2.SPCODE AND T1.MC_ACTUA = '1']]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[YB_DB_DWH_STAGE_CLIENTES]]></Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19777]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[YB_DWH_DB_CLIENTES]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[f9d370b7-59b7-4c2a-9f10-612f74ce05d3]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4996]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1548]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[160]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[15_ACTUALIZAR_CATEGORIA_PLAN_DUMMY]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[a6e21154-920f-425d-9138-c250aec33cda]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19777]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[-- Actualizar CATEGORIA_PLAN en registros nulos 
UPDATE <%=odiRef.getObjectName("TBL_DIM_PLANES_T2")%> T1
SET
  CATEGORIA_PLAN = 'Sin Categoria Asignada'
WHERE T1.CATEGORIA_PLAN IS NULL]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[YB_DB_DWH_STAGE_CLIENTES]]></Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19778]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[YB_DWH_DB_CLIENTES]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[22abcaab-bf96-4f91-be8d-0dcc384ddf88]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4997]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1548]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[170]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[16_CREAR_TEMPORAL_ESCALERA]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[fd759fe4-e203-46fa-b282-0f04d0c3c824]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19778]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[-- Actualizar CATEGORIA_ESCALERA - CATEGORIA_PREPAGO 
-- Se crea tabla tmp con la ultima versión que dejó de ser vigente para usarla como referencia en los nuevos registros 
CREATE TEMPORARY TABLE TBL_TMP_CLIEN_UPD_ESCALERA_PREPAGO AS
SELECT * FROM (
  SELECT
    SK_PLANES,
    COD_PLAN,
    TMCODE,
    SPCODE,
    PRODUCTO,
    PAQUETE_DESC,
    MC_ACTUA,
    FE_INI_VIG,
    FE_FIN_VIG,
    FE_CARGA_DWH,
    FE_ACTUALIZACION_DWH,
    CATEGORIA_ESCALERA,
    CATEGORIA_PREPAGO,
    ROW_NUMBER() OVER(PARTITION BY COD_PLAN ORDER BY FE_FIN_VIG DESC NULLS LAST) FLAG
  FROM <%=odiRef.getObjectName("TBL_DIM_PLANES_T2")%>
WHERE MC_ACTUA=0) A
WHERE FLAG=1
DISTRIBUTE ON (COD_PLAN)]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[YB_DB_DWH_STAGE_CLIENTES]]></Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19779]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[YB_DWH_DB_CLIENTES]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[52a17880-127b-41d2-88c7-2415eb8cd7ac]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4998]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1548]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[200]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[17_ACTUALIZAR_CATEGORIA_ESCALERA]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c29edad4-fa8c-403b-b57f-f9f01fb3b34d]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19779]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[-- Se actualizan los campos CATEGORIA_ESCALERA y CATEGORIA_PREPAGO 
UPDATE <%=odiRef.getObjectName("TBL_DIM_PLANES_T2")%> A
  SET CATEGORIA_ESCALERA = B.CATEGORIA_ESCALERA,
      CATEGORIA_PREPAGO = B.CATEGORIA_PREPAGO
FROM TBL_TMP_CLIEN_UPD_ESCALERA_PREPAGO B
WHERE A.COD_PLAN = B.COD_PLAN AND
A.MC_ACTUA = 1 AND
A.CATEGORIA_ESCALERA IS NULL AND
A.CATEGORIA_PREPAGO IS NULL]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[YB_DB_DWH_STAGE_CLIENTES]]></Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19780]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[YB_DWH_DB_CLIENTES]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[7a710e61-8d84-4a03-9cbc-831a928c2bf0]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4999]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1548]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[210]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[18 ACTUALIZAR_CAMPOS_CUOTA3]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[271ae79e-c156-413f-9c55-08f5188285fb]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19780]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[UPDATE <%=odiRef.getObjectName("TBL_DIM_PLANES_T2")%> A
SET
 DES_CONSU_ADI_DATOS = B.DES_CONSU_ADI_DATOS,
 COD_PERIODO_TIEMPO = B.COD_PERIODO_TIEMPO
FROM (
SELECT
  TMCODE, DES_CONSU_ADI_DATOS, COD_PERIODO_TIEMPO
FROM
  #PRY_DWH.V_0772_SISNOT_DB_DWH_STAGE.#PRY_DWH.V_0772_SISNOT_SCH_CLIENTES.TBL_CLIEN_PLANES
GROUP BY
  TMCODE, DES_CONSU_ADI_DATOS, COD_PERIODO_TIEMPO
) B
WHERE A.TMCODE = B.TMCODE]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String"><![CDATA[YB_DB_DWH_STAGE_CLIENTES]]></Field>
	<Field name="ColTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19781]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[YB_DWH_DB_CLIENTES]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[YELLOWBRICKS]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[1243a9c9-44aa-42f9-b471-ec29d0b95688]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[5000]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1548]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-11-15 17:23:58.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ECM3015G]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[80]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[create temporal motivo YB JM02102022]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[6015f204-fabb-4812-85b2-a4f05b13dacd]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[19781]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[CREATE TEMPORARY TABLE TBL_TMP_CLIEN_DET_PLAN_FIN AS
  (SELECT DISTINCT
        A.TMCODE,
        A.SPCODE,
        A.TIPO_BOLSA,
        A.TIPO_CONTROL_MAGUARE,
        A.TIPO_PLAN,
        CASE WHEN A.TIPO_MEDIDA = 'Seg' THEN 'SEGUNDOS'
             WHEN A.TIPO_MEDIDA = 'Min' THEN 'MINUTOS'
             WHEN A.TIPO_MEDIDA = 'Net' THEN 'NET'
             WHEN A.TIPO_MEDIDA = 'SMS' THEN 'SMS'
             ELSE A.TIPO_PLAN END AS TIPO_FACTURACION,
        A.PLAN_DESC_COMPLETA,
        A.VLR_CFM_VOZ,
        A.VLR_CFM_DATOS,
        A.VLR_CFM_DATOS_IMP,
        A.MIN_INC_C_F_O,
        A.MIN_INC_C,
        A.MIN_INC_F,
        A.MIN_INC_O,
        A.CANT_MIN_INC_ELEG_TD,
        A.CANT_SMS_CLARO_INC,
        A.CANT_MB_INC_PLAN,
        A.CANT_MB_BB_INC_PLAN,
        A.SEGMENTO_PLAN,
        A.NAVEGACION_PLAN,
        A.VLR_MIN_INC_CLARO,
        A.VLR_MIN_INC_FIJOS,
        A.VLR_MIN_INC_OTROS,
        A.VLR_MIN_ADIC_CLARO,
        A.VLR_MIN_ADIC_FIJOS,
        A.VLR_MIN_ADIC_OTROS,
        A.VLR_SMS_ADIC_CLARO,
        A.CANT_ELEG_FIJO,
        A.CANT_ELEG_ONNET,
        A.CANT_ELEG_OFFNET,
        A.CANT_ELEG_TD,
        A.NOMBRE_CUOTA_PCRF,
        A.TIPO_NAVEGACION_PCRF,
        A.TIPO_PLAN_PCRF,
        A.ROUTING_CATEGORY_BCSC,
        A.TECNOLOGIA,
        A.FAMILIA_PLAN,
        A.CLASE_PLAN,
        A.MIN_INC_LDI_1,
        A.MIN_INC_LDI_2,
        A.MIN_INC_LDI_RM,
        A.VALOR_ADIC_KB,
        A.COD_PASE 
  FROM
    db_dwh_stage.clientes.TBL_TMP_CLIEN_DETALLE_PLAN A
  INNER JOIN
    db_dwh_stage.clientes.TBL_TMP_CLIEN_DET_PLAN B
  ON (A.TMCODE = B.TMCODE AND A.SPCODE = B.SPCODE AND A.VERSION = B.VER))
  DISTRIBUTE ON (TMCODE)]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_FOLDER.294]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[1ca81b07-ca6b-41e2-ae83-7b23998e4ad0]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[PRY_DWH.0772_CLIEN_ACTUALIZA_DIM_PLANES]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_PROJECT.SNP_FOLDER]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[7.31]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_PROJECT.112]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[98952e46-148a-4c10-89fa-ff5c7bc9e819]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[PRY_DWH]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_PROJECT]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[7]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.19762]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[354518a6-01d2-412b-bb6a-08848a2ae683]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.19763]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[44d7a3f2-6107-4847-8f19-12abddef96f4]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TRT.1548]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[63ad64fd-8688-4e6d-a3a4-b91ae88dd74f]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[PRY_DWH.PR_0772_ACTUALIZA_DIM_PLANES]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_PROJECT.SNP_TRT]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[7.28]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.19764]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[f454ad6b-3f1d-491d-ab3e-11f2480ddbc1]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_ORIGTXT.102]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String">null</Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.19765]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[d95c2a34-077b-47ff-854f-c77cf2c9d109]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.19766]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[4ac22db6-829f-4358-ad9c-86a691764113]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.19767]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[60575457-00b9-498d-b96b-62f2bcec4244]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.19768]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[4ff10547-5a6f-4150-8893-30fae48fa0b1]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.19769]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[d77e3e95-37c2-4bdf-82eb-b3cca61d5b97]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.19770]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[2d1711a6-0919-42c9-8df1-3b5ae6a802ac]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.19771]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[bac863d2-d112-4d0d-9afe-2dc3b517b26f]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.19772]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[31d85e9f-6c8d-43ea-bc06-e5834993d1f0]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.19773]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[005ac9bc-5f22-4496-aec4-4ab571b7e4b6]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.19774]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[a8342489-4bad-44bb-abd6-38d98f93fdc1]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.19775]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[d1fe4423-1980-4faf-8e72-b851b7f706c8]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.19776]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[404c90b4-4cdb-40c4-a639-eda29097e4ae]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.19777]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[a6e21154-920f-425d-9138-c250aec33cda]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.19778]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[fd759fe4-e203-46fa-b282-0f04d0c3c824]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.19779]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[c29edad4-fa8c-403b-b57f-f9f01fb3b34d]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.19780]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[271ae79e-c156-413f-9c55-08f5188285fb]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.19781]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[6015f204-fabb-4812-85b2-a4f05b13dacd]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.DwgExportSummary">
		<Field name="ExpTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="InstObjNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="JoinColNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="JoinNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="KeyColNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="KeyNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="LinkDiagNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="MorigTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="MtxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OrigTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="OtherObjectsNb" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="PlanAgentNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="StepNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="TxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="UeOrigNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="UeUsedNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="VarPlanAgentNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OdiVersion" type="java.lang.String"><![CDATA[12.2.1]]></Field>
	<Field name="OriginRepositoryID" type="com.sunopsis.sql.DbInt"><![CDATA[11]]></Field>
	<Field name="RepositoryVersion" type="java.lang.String"><![CDATA[05.02.02.09]]></Field>
</Object>
</SunopsisExport>
