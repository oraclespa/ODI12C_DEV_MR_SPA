<?xml version="1.0" encoding="UTF-8"?>
<SunopsisExport>
<Admin RepositoryVersion="05.02.02.09" IsLegacyIdCompatible="false" />
<Encryption algorithm="AES" keyLength="128" exportKeyHash="" keyVect="K774yMMcOJe5ESH9bmd7kQ==" exportKeySalt="2b01cfc7-1ba2-4b71-b4c7-f5516c62f199" containsCipherText="false"/>
<Object class="com.sunopsis.dwg.dbobj.SnpTrt">
		<Field name="CleanupOnError" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="CompType" type="java.lang.String">null</Field>
	<Field name="DelegateClass" type="java.lang.String">null</Field>
	<Field name="DelegateScript" type="java.lang.String">null</Field>
	<Field name="ExpectedAstClass" type="java.lang.String">null</Field>
	<Field name="ExtVersion" type="java.lang.String">null</Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[9638c11f-8009-4fee-b890-d4d31dd67232]]></Field>
	<Field name="IndChange" type="java.lang.String"><![CDATA[I]]></Field>
	<Field name="IndExcludeExUnitBegin" type="java.lang.String">null</Field>
	<Field name="IndExcludeExUnitEnd" type="java.lang.String">null</Field>
	<Field name="IndExcludeExUnitMain" type="java.lang.String">null</Field>
	<Field name="IndExcludeMapBegin" type="java.lang.String">null</Field>
	<Field name="IndExcludeMapCleanup" type="java.lang.String">null</Field>
	<Field name="IndExcludeMapEnd" type="java.lang.String">null</Field>
	<Field name="IndGenerateLoad" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndIsHidden" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndJrnMethod" type="java.lang.String"><![CDATA[S]]></Field>
	<Field name="IndSuppSetBased" type="java.lang.String">null</Field>
	<Field name="IntgType" type="java.lang.String">null</Field>
	<Field name="IntVersion" type="com.sunopsis.sql.DbInt"><![CDATA[1]]></Field>
	<Field name="IsConcurrent" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IsSeeded" type="java.lang.String">null</Field>
	<Field name="IBaseCompKm" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IFolder" type="com.sunopsis.sql.DbInt"><![CDATA[243]]></Field>
	<Field name="IProject" type="com.sunopsis.sql.DbInt"><![CDATA[84]]></Field>
	<Field name="IScBaseTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScOrigTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IScTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1359]]></Field>
	<Field name="ITxtDelTxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITxtTrtTxt" type="com.sunopsis.sql.DbInt"><![CDATA[18119]]></Field>
	<Field name="KimMultiDserver" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="KmDefault" type="java.lang.String">null</Field>
	<Field name="KmLang" type="java.lang.String">null</Field>
	<Field name="KmSrcLang" type="java.lang.String">null</Field>
	<Field name="KmSrcTechno" type="java.lang.String">null</Field>
	<Field name="KmTechno" type="java.lang.String">null</Field>
	<Field name="KmVersion" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="LkmType" type="java.lang.String">null</Field>
	<Field name="LChecksum" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="LCode" type="java.lang.String">null</Field>
	<Field name="OggJkm" type="java.lang.String">null</Field>
	<Field name="OrdFolder" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ProcType" type="java.lang.String">null</Field>
	<Field name="ProdAstType" type="java.lang.String">null</Field>
	<Field name="RepGuid" type="java.lang.String">null</Field>
	<Field name="RepVersion" type="java.lang.String">null</Field>
	<Field name="ScriptPath" type="java.lang.String">null</Field>
	<Field name="ScOrigTrtTag" type="java.lang.String">null</Field>
	<Field name="Subtype" type="java.lang.String">null</Field>
	<Field name="TrtName" type="java.lang.String"><![CDATA[PR_008_ACTUALIZA_ESTADOS_HIST]]></Field>
	<Field name="TrtType" type="java.lang.String"><![CDATA[U]]></Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
	<Field name="VLastDate" type="java.sql.Timestamp">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18120]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ORC_PARAMETROS]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[bf1c4ffc-ecd6-4379-87b3-fdec8bb7ad9e]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4519]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1359]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[210]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[ACTUALIZA ESTADO BENEFICIARIO]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[3df72453-bfef-4da6-9859-f0df048f8be1]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18120]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[DECLARE
  CONST_Str_Estado_Activo                    CONSTANT VARCHAR2 (1) := 'a';
  CONST_Str_Estado_Desactivo                 CONSTANT VARCHAR2 (1) := 'd';  
  CONST_Str_Estado_Suspendido                CONSTANT VARCHAR2 (1) := 's';
  
  CONST_Num_Estado_Activo                    CONSTANT NUMBER (2)   := 10;---1 Se actualiza valor para validacion Tickler;
  CONST_Num_Estado_Desactivo                 CONSTANT NUMBER (1)   := 9;  
  CONST_Num_Estado_Suspendido                CONSTANT NUMBER (1)   := 3;
  
  CURSOR CUR_Beneficiario IS
      SELECT  B.ROWID                                                                       ROW_ID
             ,BS.CS_STAT_CHNG                                                               CS_STAT_CHNG
             ,CASE B.SK_ESTADO_BENEFI
                WHEN CONST_Num_Estado_Activo     THEN CONST_Str_Estado_Activo
                WHEN CONST_Num_Estado_Desactivo  THEN CONST_Str_Estado_Desactivo
                WHEN CONST_Num_Estado_Suspendido THEN CONST_Str_Estado_Suspendido
              END                                                                           SK_ESTADO_BENEFI
                , BS.ID_CAUSAL    							    ID_CAUSAL
		,B.ICCID																		ICCID_ACTUALIZAR
		,BS.ICCID
		,B.CAUSAL_ACTIVACION							    CAUSAL_ACTIVACION
        FROM <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> B
                JOIN <%=odiRef.getObjectName("MINTIC_DATA_BSCS_TMP_TB")%> BS
                  ON TO_CHAR(B.MIN) = TRIM(BS.DN_NUM)
       WHERE Instr (BS.CS_STAT_CHNG, '|' || TO_CHAR (TRUNC (#PRY_FABR_DIG.V_008_FEC_REG_BSCS), 'YYMMDD')) > 0
      ;      
      
  v_Nro_Ocurrencia                           PLS_INTEGER;    
  v_Estado_Actualizar                        VARCHAR2 (1);
  v_Ultimo_Estado                            VARCHAR2 (1);
  v_Causa_Actualizar                         VARCHAR2 (100);
  v_Iccid_Actualizar                         VARCHAR2 (100);
  v_Causa_New                                VARCHAR2 (100);
  v_Iccid_New                                VARCHAR2 (100); 
  
BEGIN
  
    FOR Datos IN CUR_Beneficiario LOOP
    v_Nro_Ocurrencia := 1;
    v_Ultimo_Estado := Datos.SK_ESTADO_BENEFI;
    v_Causa_Actualizar		:= SUBSTR(Datos.CAUSAL_ACTIVACION,1,INSTR(Datos.CAUSAL_ACTIVACION,'-',1)-1);
    v_Iccid_Actualizar		:= Datos.ICCID_ACTUALIZAR;
	
    LOOP                                                                                                            
      v_Estado_Actualizar := SUBSTR (Datos.CS_STAT_CHNG, Instr (Datos.CS_STAT_CHNG, '|' || TO_CHAR (TRUNC (SYSDATE-1), 'YYMMDD'), 1, v_Nro_Ocurrencia) + 7,  1);
      v_Causa_New		  := SUBSTR(Datos.ID_CAUSAL,1,INSTR(Datos.ID_CAUSAL,'-',1)-1);
      v_Iccid_New		  := Datos.ICCID;
	  
      IF v_Estado_Actualizar <> v_Ultimo_Estado THEN
        UPDATE <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> B
           SET  SK_ESTADO_BENEFI = CASE v_Estado_Actualizar
                                     WHEN CONST_Str_Estado_Activo     THEN CONST_Num_Estado_Activo
                                     WHEN CONST_Str_Estado_Desactivo  THEN CONST_Num_Estado_Desactivo
                                     WHEN CONST_Str_Estado_Suspendido THEN CONST_Num_Estado_Suspendido                                     
                                   END    
             ,Fecha_Estado     = TRUNC (#PRY_FABR_DIG.V_008_FEC_REG_BSCS)
         WHERE ROWID = Datos.ROW_ID;
         
        v_Ultimo_Estado := v_Estado_Actualizar;
      END IF; 

	IF v_Causa_Actualizar <> v_Causa_New THEN
          UPDATE <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> B
           SET  CAUSAL_ACTIVACION = Datos.ID_CAUSAL   
             ,Fecha_Estado     = TRUNC (#PRY_FABR_DIG.V_008_FEC_REG_BSCS)
           WHERE ROWID = Datos.ROW_ID;
         
        v_Causa_New := v_Causa_Actualizar;
		
	END IF;
		
	IF v_Iccid_Actualizar <> v_Iccid_New THEN
          UPDATE <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> B
           SET  ICCID = v_Iccid_New   
             ,Fecha_Estado     = TRUNC (#PRY_FABR_DIG.V_008_FEC_REG_BSCS)
           WHERE ROWID = Datos.ROW_ID;
         
            v_Iccid_New := v_Iccid_Actualizar;
		
        END IF;
        
      v_Nro_Ocurrencia := v_Nro_Ocurrencia + 1;
       
      EXIT WHEN Instr (Datos.CS_STAT_CHNG, '|' || TO_CHAR (TRUNC (#PRY_FABR_DIG.V_008_FEC_REG_BSCS), 'YYMMDD'), 1, v_Nro_Ocurrencia) = 0;
    END LOOP;  
 END LOOP;    
 COMMIT;
END;]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpOrigTxt">
		<Field name="GlobalId" type="java.lang.String">null</Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="OrigineName" type="java.lang.String"><![CDATA[Target Technology]]></Field>
	<Field name="SnpsCol" type="java.lang.String"><![CDATA[DEF_I_TXT]]></Field>
	<Field name="SnpsTable" type="java.lang.String"><![CDATA[SNP_LINE_TRT]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18121]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ORC_PARAMETROS]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[258b79be-9652-48ba-8be7-df3ece3597c7]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4520]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1359]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[MC]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[190]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[ACTUALIZA ID BENEFICIARIO DEPTO - MUNICIPIO]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c720ffc0-9f7f-4068-8796-d85bea8ea90f]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18121]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[MERGE INTO <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T1
USING (
WITH QUERY1 AS (
SELECT
*
FROM (
SELECT 
     T1.SK_ETAPA 
    ,CASE
        WHEN TOTAL_ACTIVOS IS NULL THEN 0 ELSE TOTAL_ACTIVOS END TOTAL_ACTIVOS
    
FROM <%=odiRef.getObjectName("MINTIC_ESTADO_ETAPA_DIM_TB_T1")%> T1
LEFT JOIN (
SELECT
     T1.SK_ETAPA AS SK_ETAPAS
    ,COUNT(*) TOTAL_ACTIVOS
FROM <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T1
JOIN <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> T2
ON (CASE
      WHEN T1.SK_CATEG_BENEF = 1 THEN T1.NUM_IDENT_MENOR ELSE T1.NUM_DOC END = T2.NUM_DOC)
WHERE T2.SK_ESTADO_BENEFI IN (1,3)
GROUP BY SK_ETAPA) T2
ON (T1.SK_ETAPA = T2.SK_ETAPAS))
WHERE TOTAL_ACTIVOS <> 0)
,QUERY2 AS (
SELECT 
	 T1.NUM_DOC
    ,T1.FECHA_ESTADO
    ,T2.MIN
    ,T3.SK_ETAPA
    ,ROW_NUMBER() OVER (PARTITION BY T3.SK_ETAPA ORDER BY T1.FECHA_ESTADO ASC) + MAX_ID_BENE AS ID_BENEFICIARIO
FROM <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> T1
JOIN <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T2
ON (T1.NUM_DOC = (CASE WHEN SK_CATEG_BENEF = 1 THEN T2. NUM_IDENT_MENOR ELSE T2.NUM_DOC END)
AND T1.MIN = T2.MIN)
JOIN <%=odiRef.getObjectName("MINTIC_ESTADO_ETAPA_DIM_TB_T1")%> T3
ON (T3.SK_ETAPA = T2.SK_ETAPA)
LEFT JOIN (SELECT
            MAX(NVL(ID_BENEFICIARIO,0)) AS MAX_ID_BENE
            ,SK_ETAPA
      FROM MINTIC_INFO_BASE_BENEFI_TB
      GROUP BY SK_ETAPA) T4 
ON (T4.SK_ETAPA = T3.SK_ETAPA)
WHERE T1.SK_ESTADO_BENEFI IN (1,3)
AND T2.ID_BENEFICIARIO IS NULL)
,QUERY3 AS (
SELECT 
     META_ETAPA
    ,SK_ETAPA
FROM <%=odiRef.getObjectName("MINTIC_ESTADO_ETAPA_DIM_TB_T1")%>
)
SELECT
     T2.ID_BENEFICIARIO
    ,T2.NUM_DOC
    ,T2.MIN
FROM QUERY1 T1
JOIN QUERY2 T2
ON (T1.SK_ETAPA = T2.SK_ETAPA)
JOIN QUERY3 T3
ON (T1.SK_ETAPA = T3.SK_ETAPA AND T3.SK_ETAPA = T2.SK_ETAPA)
WHERE T2.ID_BENEFICIARIO <= T3.META_ETAPA) T2
ON ((CASE WHEN T1.SK_CATEG_BENEF = 1 THEN T1.NUM_IDENT_MENOR ELSE T1.NUM_DOC END) = T2.NUM_DOC)
WHEN MATCHED THEN
UPDATE SET T1.ID_BENEFICIARIO = T2.ID_BENEFICIARIO
WHERE T1.ID_BENEFICIARIO IS NULL


]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18122]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ORC_PARAMETROS]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[67209fa0-a1c5-4ac9-9314-894bbc96e581]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4521]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1359]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[ACTUALIZA ICCID POR CAMBIO EN BSCS]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[e24b217d-f36c-4e42-982a-86f8932768fc]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18122]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[MERGE INTO <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> T1
USING (
SELECT
*
FROM(
SELECT
     CAST(REGEXP_REPLACE(T1.ICCID , '[^0-9]+', '') AS NUMBER) AS ICCID
    ,CAST(REGEXP_REPLACE(SUBSTR(T1.ICCID,1,19) , '[^0-9]+', '') AS NUMBER) AS ICCID_PARA_ODI 
    ,CAST(REGEXP_REPLACE(T2.ICCID_BSCS , '[^0-9]+', '') AS NUMBER) AS ICCID_BSCS
    ,CASE
        WHEN CAST(REGEXP_REPLACE(T1.ICCID , '[^0-9]+', '') AS NUMBER) = CAST(REGEXP_REPLACE(T2.ICCID_BSCS , '[^0-9]+', '') AS NUMBER) THEN 'BIEN' ELSE 'MAL' END AS VALIDA_ICCID
    ,T1.DN_NUM
    ,SK_ESTADO_BENEFI
FROM <%=odiRef.getObjectName("MINTIC_DATA_BSCS_TMP_TB")%> T1
JOIN <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> T2
ON (T1.DN_NUM = T2.MIN)
WHERE T2.SK_ESTADO_BENEFI IN (1,3))
WHERE VALIDA_ICCID = 'MAL') T2
ON (T1.MIN = T2.DN_NUM)
WHEN MATCHED THEN
UPDATE SET T1.ICCID_BSCS = T2.ICCID
,T1.ICCID = T2.ICCID_PARA_ODI
,FECHA_ESTADO = SYSDATE]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18123]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ORC_PARAMETROS]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[77e6ccc3-8f69-4e0f-9847-0ed2fc9fa580]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4522]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1359]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[30]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[ACTUALIZA ESTADO POR CAMBIO EN BSCS]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[7f40f868-a74b-4a15-aa38-e638a566b9a1]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18123]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[MERGE INTO <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> T1
USING (
SELECT
*
FROM(
SELECT
     CASE
        WHEN SK_ESTADO_BENEFI = ESTADO_BSCS THEN 'Bien' ELSE 'Mal' END ESTADO
    ,A.SK_ESTADO_BENEFI
    ,A.MIN
    ,A.ESTADO_BSCS
    ,TO_DATE(A.FEC_ESTADO_BSCS,'YYMMDD') AS FEC_ESTADO_BSCS
    ,A.F_ESTADO_ACTUAL
    ,A.F_ESTADO_ANTERIOR
    ,A.CS_STAT_CHNG
    ,A.ID_CAUSAL
FROM (
SELECT
     T2.SK_ESTADO_BENEFI
    ,T2.MIN
    ,CASE
        WHEN SUBSTR(T1.CS_STAT_CHNG,-1) = 'a' THEN 1
        WHEN SUBSTR(T1.CS_STAT_CHNG,-1) = 's' THEN 3
        WHEN SUBSTR(T1.CS_STAT_CHNG,-1) = 'd' THEN 9
        END ESTADO_BSCS
    ,SUBSTR(T1.CS_STAT_CHNG,INSTR(T1.CS_STAT_CHNG,'|',1,LENGTH(T1.CS_STAT_CHNG) - LENGTH(REPLACE(T1.CS_STAT_CHNG,'|')))+1,6) AS FEC_ESTADO_BSCS
    ,SUBSTR(T1.CS_STAT_CHNG,INSTR(T1.CS_STAT_CHNG,'|',1,LENGTH(T1.CS_STAT_CHNG) - LENGTH(REPLACE(T1.CS_STAT_CHNG,'|')))+1,6) AS F_ESTADO_ACTUAL
    ,CASE
        WHEN LENGTH(T1.CS_STAT_CHNG) - LENGTH(REPLACE(T1.CS_STAT_CHNG,'|')) - 1 = 0 THEN SUBSTR(T1.CS_STAT_CHNG,INSTR(T1.CS_STAT_CHNG,'|',1)+1,6) 
        ELSE SUBSTR(T1.CS_STAT_CHNG,INSTR(T1.CS_STAT_CHNG,'|',1,LENGTH(T1.CS_STAT_CHNG) - LENGTH(REPLACE(T1.CS_STAT_CHNG,'|')) - 1)+1,6) END AS F_ESTADO_ANTERIOR
    ,T1.CS_STAT_CHNG
    ,T1.ID_CAUSAL
FROM <%=odiRef.getObjectName("MINTIC_DATA_BSCS_TMP_TB")%> T1
LEFT JOIN <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> T2
ON (T1.DN_NUM = T2.MIN)
WHERE INSTR(CS_STAT_CHNG,'|') > 0
AND SK_ESTADO_BENEFI IN (1,3,9)) A) B
WHERE ESTADO = 'Mal') T2
ON (T1.MIN = T2.MIN)
WHEN MATCHED THEN
UPDATE SET T1.SK_ESTADO_BENEFI = T2.ESTADO_BSCS
,T1.FECHA_ESTADO = T2.FEC_ESTADO_BSCS
,T1.CAUSAL_DESACTIVACION = T2.ID_CAUSAL]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18124]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ORC_PARAMETROS]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[fe13c8df-053d-4b17-9f49-bee68558f565]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4523]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1359]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[60]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[ACTULIZA ID_BENEFICARIO DE LOS DESACTIVOS SK_ETAPA]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[5c8f1306-2e73-408b-8d00-331ad91d4eb2]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18124]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[MERGE INTO <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T1
USING (
WITH QUERY1 AS (
SELECT
     (CASE WHEN T2.SK_CATEG_BENEF = 1 THEN T2.NUM_IDENT_MENOR ELSE T2.NUM_DOC END) AS NUM_DOC_UM_Q1
    ,T1.MIN AS MIN_Q1
    ,T1.SK_ESTADO_BENEFI AS SK_ESTADO_BENEFI_Q1
    ,T2.SK_ETAPA AS SK_ETAPA_Q1
    ,T2.META AS META_Q1
    ,T3.META_ETAPA AS META_ETAPA_Q1
    ,T2.ID_BENEFICIARIO AS ID_BENEFICIARIO_Q1
    ,T2.BAN_ESTADO_REG AS BAN_ESTADO_REG_Q1
    ,ROW_NUMBER() OVER (PARTITION BY T3.ETAPA, T2.SK_ETAPA ORDER BY T2.SK_ETAPA , T1.FECHA_ESTADO) AS FLAG_Q1
FROM <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> T1
JOIN <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T2
ON (T1.NUM_DOC = (CASE WHEN T2.SK_CATEG_BENEF = 1 THEN T2.NUM_IDENT_MENOR ELSE T2.NUM_DOC END))
JOIN <%=odiRef.getObjectName("MINTIC_ESTADO_ETAPA_DIM_TB_T1")%> T3
ON (T2.SK_ETAPA = T3.SK_ETAPA)
WHERE T1.SK_ESTADO_BENEFI = 9
AND T2.SK_ETAPA != -1
), QUERY2 AS (
SELECT
     SK_ETAPA AS SK_ETAPA_Q2
    ,COUNT(SK_ETAPA) AS TOTAL_ETAPA_UM_Q2
FROM <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%>
GROUP BY SK_ETAPA
), QUERY3 AS (
SELECT
    (CASE WHEN T2.SK_CATEG_BENEF = 1 THEN T2.NUM_IDENT_MENOR ELSE T2.NUM_DOC END) AS NUM_DOC_UM_Q3
    ,T1.MIN AS MIN_Q3
    ,T1.SK_ESTADO_BENEFI AS SK_ESTADO_BENEFI_Q3
    ,T2.SK_ETAPA AS SK_ETAPA_Q3
    ,T2.META AS META_Q3
    ,T2.ID_BENEFICIARIO AS ID_BENEFICIARIO_Q3
    ,T2.BAN_ESTADO_REG AS BAN_ESTADO_REG_Q3
    ,ROW_NUMBER() OVER (PARTITION BY T3.ETAPA, T2.SK_ETAPA ORDER BY T2.SK_ETAPA , T1.FECHA_ESTADO) AS FLAG_Q3
FROM <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> T1
JOIN <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T2
ON (T1.NUM_DOC = (CASE WHEN T2.SK_CATEG_BENEF = 1 THEN T2.NUM_IDENT_MENOR ELSE T2.NUM_DOC END))
JOIN <%=odiRef.getObjectName("MINTIC_ESTADO_ETAPA_DIM_TB_T1")%> T3
ON (T2.SK_ETAPA = T3.SK_ETAPA)
WHERE T1.SK_ESTADO_BENEFI = 13 
AND ID_BENEFICIARIO = -1
AND T2.SK_ETAPA != -1
)
SELECT
     T1.NUM_DOC_UM_Q1 
    ,T1.MIN_Q1
    ,T1.SK_ESTADO_BENEFI_Q1
    ,T1.SK_ETAPA_Q1
    ,T1.ID_BENEFICIARIO_Q1
    ,T1.BAN_ESTADO_REG_Q1
    ,(T1.META_ETAPA_Q1 - T2.TOTAL_ETAPA_UM_Q2) AS DIFERENCIA
    ,T3.NUM_DOC_UM_Q3
    ,T3.MIN_Q3
    ,T3.SK_ESTADO_BENEFI_Q3
    ,T3.ID_BENEFICIARIO_Q3
    ,T3.BAN_ESTADO_REG_Q3
FROM QUERY1 T1
JOIN QUERY2 T2
ON (T1.SK_ETAPA_Q1 = T2.SK_ETAPA_Q2)
JOIN QUERY3 T3
ON (T1.SK_ETAPA_Q1 = T3.SK_ETAPA_Q3 AND T1.META_Q1 = T3.META_Q3 AND T1.FLAG_Q1 = T3.FLAG_Q3)) T2
ON ((CASE WHEN T1.SK_CATEG_BENEF = 1 THEN T1.NUM_IDENT_MENOR ELSE T1.NUM_DOC END) = T2.NUM_DOC_UM_Q3)
WHEN MATCHED THEN
UPDATE SET T1.ID_BENEFICIARIO = T2.ID_BENEFICIARIO_Q1
WHERE /*T2.DIFERENCIA > 0
AND */T2.SK_ESTADO_BENEFI_Q3 = 13
AND T2.ID_BENEFICIARIO_Q3 = -1
AND T2.BAN_ESTADO_REG_Q1 = 5
AND T2.BAN_ESTADO_REG_Q3 = 3]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18125]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ORC_PARAMETROS]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[9827ed19-a672-4617-a771-a93466b3db31]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4524]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1359]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[70]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[ACTUALIZA LINEA DESACTIVA A DEFAULT]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[df398ed0-9a94-4179-9b8e-2a6bdd3d75ec]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18125]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[MERGE INTO <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T1
USING (WITH QUERY1 AS (
SELECT
     (CASE WHEN T2.SK_CATEG_BENEF = 1 THEN T2.NUM_IDENT_MENOR ELSE T2.NUM_DOC END) AS NUM_DOC_UM_Q1
    ,T1.MIN AS MIN_Q1
    ,T1.SK_ESTADO_BENEFI AS SK_ESTADO_BENEFI_Q1
    ,T2.SK_ETAPA AS SK_ETAPA_Q1
    ,T2.META AS META_Q1
    ,T3.META_ETAPA AS META_ETAPA_Q1
    ,T2.ID_BENEFICIARIO AS ID_BENEFICIARIO_Q1
    ,T2.BAN_ESTADO_REG AS BAN_ESTADO_REG_Q1
FROM <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> T1
JOIN <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T2
ON (T1.NUM_DOC = (CASE WHEN T2.SK_CATEG_BENEF = 1 THEN T2.NUM_IDENT_MENOR ELSE T2.NUM_DOC END))
JOIN <%=odiRef.getObjectName("MINTIC_ESTADO_ETAPA_DIM_TB_T1")%> T3
ON (T2.SK_ETAPA = T3.SK_ETAPA)
WHERE T1.SK_ESTADO_BENEFI = 9
AND T2.SK_ETAPA != -1
), QUERY2 AS (
SELECT
     SK_ETAPA AS SK_ETAPA_Q2
    ,COUNT(SK_ETAPA) AS TOTAL_ETAPA_UM_Q2
FROM <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%>
GROUP BY SK_ETAPA
), QUERY3 AS (
SELECT
    (CASE WHEN T2.SK_CATEG_BENEF = 1 THEN T2.NUM_IDENT_MENOR ELSE T2.NUM_DOC END) AS NUM_DOC_UM_Q3
    ,T1.MIN AS MIN_Q3
    ,T1.SK_ESTADO_BENEFI AS SK_ESTADO_BENEFI_Q3
    ,T2.SK_ETAPA AS SK_ETAPA_Q3
    ,T2.META AS META_Q3
    ,T2.ID_BENEFICIARIO AS ID_BENEFICIARIO_Q3
    ,T2.BAN_ESTADO_REG AS BAN_ESTADO_REG_Q3
FROM <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> T1
JOIN <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T2
ON (T1.NUM_DOC = (CASE WHEN T2.SK_CATEG_BENEF = 1 THEN T2.NUM_IDENT_MENOR ELSE T2.NUM_DOC END))
JOIN <%=odiRef.getObjectName("MINTIC_ESTADO_ETAPA_DIM_TB_T1")%> T3
ON (T2.SK_ETAPA = T3.SK_ETAPA)
WHERE T1.SK_ESTADO_BENEFI = 13 
AND ID_BENEFICIARIO NOT IN (-1)
AND T2.SK_ETAPA != -1
)
SELECT
     T1.NUM_DOC_UM_Q1 
    ,T1.MIN_Q1
    ,T1.SK_ESTADO_BENEFI_Q1
    ,T1.BAN_ESTADO_REG_Q1
    ,T3.NUM_DOC_UM_Q3
    ,T3.MIN_Q3
    ,T3.SK_ESTADO_BENEFI_Q3
    ,T3.BAN_ESTADO_REG_Q3
FROM QUERY1 T1
JOIN QUERY2 T2
ON (T1.SK_ETAPA_Q1 = T2.SK_ETAPA_Q2)
JOIN QUERY3 T3
ON (T1.SK_ETAPA_Q1 = T3.SK_ETAPA_Q3 AND T1.META_Q1 = T3.META_Q3 AND T1.ID_BENEFICIARIO_Q1 = T3.ID_BENEFICIARIO_Q3)) T2
ON ((CASE WHEN T1.SK_CATEG_BENEF = 1 THEN T1.NUM_IDENT_MENOR ELSE T1.NUM_DOC END) = T2.NUM_DOC_UM_Q1)
WHEN MATCHED THEN
UPDATE SET T1.SK_ETAPA = -1
,T1.SK_EST_LLAMADA = 35
,T1.MIN = -1
,T1.BAN_ESTADO_REG = 6
WHERE T2.SK_ESTADO_BENEFI_Q1 = 9
AND T2.BAN_ESTADO_REG_Q1 = 5
AND T2.BAN_ESTADO_REG_Q3 = 3]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18126]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ORC_PARAMETROS]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d12e5601-0cce-4911-abe0-59c66b30ea2b]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4525]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1359]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[140]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[ACTULIZA DATOS BENEFICAIRIO DESACTIVOS]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[e63dcfd7-54cb-4936-a007-dfc85bf5c993]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18126]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[MERGE INTO <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> T1
USING (
SELECT
     T1.NUM_DOC
    ,T1.MIN
FROM <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> T1
JOIN <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T2
ON ((CASE WHEN T2.SK_CATEG_BENEF = 1 THEN T2.NUM_IDENT_MENOR ELSE T2.NUM_DOC END) = T1.NUM_DOC)
WHERE SK_ESTADO_BENEFI = 9
AND BAN_ESTADO_REG = 6) T2
ON (T1.NUM_DOC = T2.NUM_DOC AND T1.MIN = T2.MIN)
WHEN MATCHED THEN
UPDATE SET T1.SK_ESTADO_BENEFI = 2
,T1.FECHA_ESTADO = SYSDATE]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18127]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ORC_PARAMETROS]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[03abba3f-65de-42bc-a975-91c19337b673]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4526]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1359]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[150]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[ACTUALIZA PLAN ENTREGA DESACTIVOS]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[de570367-ab9a-46d8-8547-dd7a8ce65015]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18127]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[DECLARE

CURSOR CUR_estados IS
    SELECT
         T1.NUM_DOC
        ,T2.MIN
    FROM <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> T1
    JOIN <%=odiRef.getObjectName("MINTIC_INFO_PLAN_ENTREGA_TB")%> T2
    ON (T1.NUM_DOC = T2.NUM_DOC AND T1.MIN = T2.MIN)
    WHERE SK_ESTADO_BENEFI = 2
    ;

BEGIN

    FOR Datos IN CUR_estados LOOP 
    DELETE FROM <%=odiRef.getObjectName("MINTIC_INFO_PLAN_ENTREGA_TB")%> T1
    WHERE T1.NUM_DOC = Datos.NUM_DOC
    AND MIN = Datos.MIN;
            
    END LOOP;
COMMIT;
END;]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18128]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ORC_PARAMETROS]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[509d32fd-6d69-4815-8f74-6561e9ca3d18]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4527]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1359]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[160]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[ACTUALZIA TABLA ACTIVACIONES DESACTIVAS ]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[68bdd084-2cfa-470d-a812-740e73b95e4a]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18128]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[DECLARE

CURSOR CUR_estados IS
    SELECT
         T1.NUM_DOC
        ,T1.MIN
    FROM <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> T1
    JOIN <%=odiRef.getObjectName("MINTIC_ACTIVACIONES_TB")%> T2
    ON (T1.MIN = T2.CODMIN)
    WHERE T1.SK_ESTADO_BENEFI = 2
    ;

BEGIN

    FOR Datos IN CUR_estados LOOP 
    DELETE FROM <%=odiRef.getObjectName("MINTIC_ACTIVACIONES_TB")%> T1
    WHERE T1.CODMIN = Datos.MIN;
            
    END LOOP;
COMMIT;
END;]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18129]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ORC_PARAMETROS]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[f5264c48-3054-4965-b74d-f0090cd770ee]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4528]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1359]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[80]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[ACTULIZA ID_BENEFICARIO DE LOS DESACTIVOS DEPARTAMENTO]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[8db7851b-57fe-43eb-8c60-7dd3b7c04132]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18129]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[MERGE INTO <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T1
USING (WITH QUERY1 AS (
SELECT
     (CASE WHEN T2.SK_CATEG_BENEF = 1 THEN T2.NUM_IDENT_MENOR ELSE T2.NUM_DOC END) AS NUM_DOC_UM_Q1
    ,T1.MIN AS MIN_Q1
    ,T1.SK_ESTADO_BENEFI AS SK_ESTADO_BENEFI_Q1
    ,T2.SK_ETAPA AS SK_ETAPA_Q1
    ,T2.META AS META_Q1
    ,T3.META_ETAPA AS META_ETAPA_Q1
    ,T2.ID_BENEFICIARIO AS ID_BENEFICIARIO_Q1
    ,T4.COD_DEPARTAMENTO AS COD_DEPARTAMENTO_Q1
    ,T2.BAN_ESTADO_REG AS BAN_ESTADO_REG_Q1
    ,ROW_NUMBER() OVER (PARTITION BY T4.COD_DEPARTAMENTO, T2.META ORDER BY T2.META , T1.FECHA_ESTADO) AS FLAG_Q1
FROM <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> T1
JOIN <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T2
ON (T1.NUM_DOC = (CASE WHEN T2.SK_CATEG_BENEF = 1 THEN T2.NUM_IDENT_MENOR ELSE T2.NUM_DOC END))
JOIN <%=odiRef.getObjectName("MINTIC_ESTADO_ETAPA_DIM_TB_T1")%> T3
ON (T2.SK_ETAPA = T3.SK_ETAPA)
JOIN <%=odiRef.getObjectName("TBL_DIM_MUNICIPIOS_DANE_T1")%> T4
ON (T2.SK_MUNICIPIO = T4.SK_MUNICIPIO)
WHERE T1.SK_ESTADO_BENEFI = 9
AND T2.SK_ETAPA != -1
), QUERY2 AS (
SELECT
     SK_ETAPA AS SK_ETAPA_Q2
    ,COUNT(SK_ETAPA) AS TOTAL_ETAPA_UM_Q2
FROM <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%>
GROUP BY SK_ETAPA
), QUERY3 AS (
SELECT
    (CASE WHEN T2.SK_CATEG_BENEF = 1 THEN T2.NUM_IDENT_MENOR ELSE T2.NUM_DOC END) AS NUM_DOC_UM_Q3
    ,T1.MIN AS MIN_Q3
    ,T1.SK_ESTADO_BENEFI AS SK_ESTADO_BENEFI_Q3
    ,T2.SK_ETAPA AS SK_ETAPA_Q3
    ,T2.META AS META_Q3
    ,T2.ID_BENEFICIARIO AS ID_BENEFICIARIO_Q3
    ,T4.COD_DEPARTAMENTO AS COD_DEPARTAMENTO_Q3
    ,T2.BAN_ESTADO_REG AS BAN_ESTADO_REG_Q3
    ,ROW_NUMBER() OVER (PARTITION BY T4.COD_DEPARTAMENTO, T2.META ORDER BY T2.META , T1.FECHA_ESTADO) AS FLAG_Q3
FROM <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> T1
JOIN <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T2
ON (T1.NUM_DOC = (CASE WHEN T2.SK_CATEG_BENEF = 1 THEN T2.NUM_IDENT_MENOR ELSE T2.NUM_DOC END))
JOIN <%=odiRef.getObjectName("MINTIC_ESTADO_ETAPA_DIM_TB_T1")%> T3
ON (T2.SK_ETAPA = T3.SK_ETAPA)
JOIN <%=odiRef.getObjectName("TBL_DIM_MUNICIPIOS_DANE_T1")%> T4
ON (T2.SK_MUNICIPIO = T4.SK_MUNICIPIO)
WHERE T1.SK_ESTADO_BENEFI = 13 
AND ID_BENEFICIARIO = -1
AND T2.SK_ETAPA != -1
)
SELECT
     T1.NUM_DOC_UM_Q1 
    ,T1.MIN_Q1
    ,T1.SK_ESTADO_BENEFI_Q1
    ,T1.SK_ETAPA_Q1
    ,T1.META_Q1
    ,T1.META_ETAPA_Q1
    ,T2.TOTAL_ETAPA_UM_Q2
    ,T1.ID_BENEFICIARIO_Q1
    ,T1.COD_DEPARTAMENTO_Q1
    ,T1.BAN_ESTADO_REG_Q1
    ,(T1.META_ETAPA_Q1 - T2.TOTAL_ETAPA_UM_Q2) AS DIFERENCIA
    ,T3.NUM_DOC_UM_Q3
    ,T3.MIN_Q3
    ,T3.SK_ESTADO_BENEFI_Q3
    ,T3.SK_ETAPA_Q3
    ,T3.ID_BENEFICIARIO_Q3
    ,T3.COD_DEPARTAMENTO_Q3
    ,T3.BAN_ESTADO_REG_Q3
FROM QUERY1 T1
JOIN QUERY2 T2
ON (T1.SK_ETAPA_Q1 = T2.SK_ETAPA_Q2)
JOIN QUERY3 T3
ON (T1.COD_DEPARTAMENTO_Q1 = T3.COD_DEPARTAMENTO_Q3 AND T1.META_Q1 = T3.META_Q3 AND T1.FLAG_Q1 = T3.FLAG_Q3)) T2
ON ((CASE WHEN T1.SK_CATEG_BENEF = 1 THEN T1.NUM_IDENT_MENOR ELSE T1.NUM_DOC END) = T2.NUM_DOC_UM_Q3)
WHEN MATCHED THEN
UPDATE SET T1.ID_BENEFICIARIO = T2.ID_BENEFICIARIO_Q1
,T1.BAN_ESTADO_REG = -1
WHERE /*T2.DIFERENCIA > 0
AND */T2.ID_BENEFICIARIO_Q3 = -1
AND T2.BAN_ESTADO_REG_Q1 = 5
AND T2.BAN_ESTADO_REG_Q3 = 3
AND SK_ESTADO_BENEFI_Q1 = 9
AND SK_ESTADO_BENEFI_Q3 = 13]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18130]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ORC_PARAMETROS]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[32fdb625-ffa4-4bb6-8048-308d0e2772a8]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4529]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1359]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[90]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[ACTUALIZA LINEA DESACTIVA A DEFAULT DEPARTAMENTO]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d7b31c34-9e78-49f3-beac-cbd6da89b0ef]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18130]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[MERGE INTO <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T1
USING (WITH QUERY1 AS (
SELECT
     (CASE WHEN T2.SK_CATEG_BENEF = 1 THEN T2.NUM_IDENT_MENOR ELSE T2.NUM_DOC END) AS NUM_DOC_UM_Q1
    ,T1.MIN AS MIN_Q1
    ,T1.SK_ESTADO_BENEFI AS SK_ESTADO_BENEFI_Q1
    ,T2.SK_ETAPA AS SK_ETAPA_Q1
    ,T2.META AS META_Q1
    ,T3.META_ETAPA AS META_ETAPA_Q1
    ,T2.ID_BENEFICIARIO AS ID_BENEFICIARIO_Q1
    ,T4.COD_DEPARTAMENTO AS COD_DEPARTAMENTO_Q1
    ,T2.BAN_ESTADO_REG AS BAN_ESTADO_REG_Q1
    ,ROW_NUMBER() OVER (PARTITION BY T4.COD_DEPARTAMENTO, T2.META ORDER BY T2.META , T1.FECHA_ESTADO) AS FLAG_Q1
FROM <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> T1
JOIN <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T2
ON (T1.NUM_DOC = (CASE WHEN T2.SK_CATEG_BENEF = 1 THEN T2.NUM_IDENT_MENOR ELSE T2.NUM_DOC END))
JOIN <%=odiRef.getObjectName("MINTIC_ESTADO_ETAPA_DIM_TB_T1")%> T3
ON (T2.SK_ETAPA = T3.SK_ETAPA)
JOIN <%=odiRef.getObjectName("TBL_DIM_MUNICIPIOS_DANE_T1")%> T4
ON (T2.SK_MUNICIPIO = T4.SK_MUNICIPIO)
WHERE T1.SK_ESTADO_BENEFI = 9
AND T2.SK_ETAPA != -1
), QUERY2 AS (
SELECT
     SK_ETAPA AS SK_ETAPA_Q2
    ,COUNT(SK_ETAPA) AS TOTAL_ETAPA_UM_Q2
FROM <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%>
GROUP BY SK_ETAPA
), QUERY3 AS (
SELECT
    (CASE WHEN T2.SK_CATEG_BENEF = 1 THEN T2.NUM_IDENT_MENOR ELSE T2.NUM_DOC END) AS NUM_DOC_UM_Q3
    ,T1.MIN AS MIN_Q3
    ,T1.SK_ESTADO_BENEFI AS SK_ESTADO_BENEFI_Q3
    ,T2.SK_ETAPA AS SK_ETAPA_Q3
    ,T2.META AS META_Q3
    ,T2.ID_BENEFICIARIO AS ID_BENEFICIARIO_Q3
    ,T4.COD_DEPARTAMENTO AS COD_DEPARTAMENTO_Q3
    ,T2.BAN_ESTADO_REG AS BAN_ESTADO_REG_Q3
    ,ROW_NUMBER() OVER (PARTITION BY T4.COD_DEPARTAMENTO, T2.META ORDER BY T2.META , T1.FECHA_ESTADO) AS FLAG_Q3
FROM <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> T1
JOIN <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T2
ON (T1.NUM_DOC = (CASE WHEN T2.SK_CATEG_BENEF = 1 THEN T2.NUM_IDENT_MENOR ELSE T2.NUM_DOC END))
JOIN <%=odiRef.getObjectName("MINTIC_ESTADO_ETAPA_DIM_TB_T1")%> T3
ON (T2.SK_ETAPA = T3.SK_ETAPA)
JOIN <%=odiRef.getObjectName("TBL_DIM_MUNICIPIOS_DANE_T1")%> T4
ON (T2.SK_MUNICIPIO = T4.SK_MUNICIPIO)
WHERE T1.SK_ESTADO_BENEFI = 13
AND ID_BENEFICIARIO NOT IN (-1)
AND T2.SK_ETAPA != -1
AND T2.BAN_ESTADO_REG = -1
)
SELECT
     T1.NUM_DOC_UM_Q1 
    ,T1.MIN_Q1
    ,T1.SK_ESTADO_BENEFI_Q1
    ,T1.BAN_ESTADO_REG_Q1
    ,T1.ID_BENEFICIARIO_Q1
    /*,T3.NUM_DOC_UM_Q3
    ,T3.MIN_Q3
    ,T3.BAN_ESTADO_REG_Q3
    ,T3.ID_BENEFICIARIO_Q3
    ,T3.SK_ESTADO_BENEFI_Q3*/
FROM QUERY1 T1
JOIN QUERY2 T2
ON (T1.SK_ETAPA_Q1 = T2.SK_ETAPA_Q2)
JOIN QUERY3 T3
ON (T1.META_Q1 = T3.META_Q3 AND T1.ID_BENEFICIARIO_Q1 = T3.ID_BENEFICIARIO_Q3 AND T1.COD_DEPARTAMENTO_Q1 = T3.COD_DEPARTAMENTO_Q3)
GROUP BY T1.NUM_DOC_UM_Q1 
    ,T1.MIN_Q1
    ,T1.SK_ESTADO_BENEFI_Q1
    ,T1.BAN_ESTADO_REG_Q1
    ,T1.ID_BENEFICIARIO_Q1) T2
ON ((CASE WHEN T1.SK_CATEG_BENEF = 1 THEN T1.NUM_IDENT_MENOR ELSE T1.NUM_DOC END) = T2.NUM_DOC_UM_Q1)
WHEN MATCHED THEN
UPDATE SET T1.SK_ETAPA = -1
,T1.SK_EST_LLAMADA = 35
,T1.MIN = -1
,T1.BAN_ESTADO_REG = 6
WHERE T2.SK_ESTADO_BENEFI_Q1 = 9]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18131]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ORC_PARAMETROS]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[3e5c1998-e9ea-4b95-8d7f-449501cf19ea]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4530]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1359]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[100]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[ACTUALZIA ESTADO -1 A 3]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[b3b17475-f8aa-4a83-8139-f5d0fd17eac6]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18131]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[BEGIN
UPDATE <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%>
SET BAN_ESTADO_REG = 3
WHERE BAN_ESTADO_REG = -1;
COMMIT;
END;]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18132]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ORC_PARAMETROS]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c940198c-77f9-454c-b3dd-5a57298a1b09]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4531]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1359]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[110]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[ACTUALIZA ID_BENEFICAIRIO DE DESACTIVOS GENERAL]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[006506a4-bad0-4f50-bcc6-ca20926e6629]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18132]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[MERGE INTO <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T1
USING (WITH QUERY1 AS (
SELECT
     (CASE WHEN T2.SK_CATEG_BENEF = 1 THEN T2.NUM_IDENT_MENOR ELSE T2.NUM_DOC END) AS NUM_DOC_UM_Q1
    ,T1.MIN AS MIN_Q1
    ,T1.SK_ESTADO_BENEFI AS SK_ESTADO_BENEFI_Q1
    ,T2.SK_ETAPA AS SK_ETAPA_Q1
    ,T2.META AS META_Q1
    ,T3.META_ETAPA AS META_ETAPA_Q1
    ,T2.ID_BENEFICIARIO AS ID_BENEFICIARIO_Q1
    ,ROW_NUMBER() OVER (PARTITION BY T2.META ORDER BY T2.META , T1.FECHA_ESTADO) AS FLAG_Q1
    ,T2.BAN_ESTADO_REG AS BAN_ESTADO_REG_Q1
FROM <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> T1
JOIN <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T2
ON (T1.NUM_DOC = (CASE WHEN T2.SK_CATEG_BENEF = 1 THEN T2.NUM_IDENT_MENOR ELSE T2.NUM_DOC END))
JOIN <%=odiRef.getObjectName("MINTIC_ESTADO_ETAPA_DIM_TB_T1")%> T3
ON (T2.SK_ETAPA = T3.SK_ETAPA)
WHERE T1.SK_ESTADO_BENEFI = 9
AND T2.SK_ETAPA != -1
), QUERY2 AS (
SELECT
     SK_ETAPA AS SK_ETAPA_Q2
    ,COUNT(SK_ETAPA) AS TOTAL_ETAPA_UM_Q2
FROM <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%>
GROUP BY SK_ETAPA
), QUERY3 AS (
SELECT
    (CASE WHEN T2.SK_CATEG_BENEF = 1 THEN T2.NUM_IDENT_MENOR ELSE T2.NUM_DOC END) AS NUM_DOC_UM_Q3
    ,T1.MIN AS MIN_Q3
    ,T1.SK_ESTADO_BENEFI AS SK_ESTADO_BENEFI_Q3
    ,T2.SK_ETAPA AS SK_ETAPA_Q3
    ,T2.META AS META_Q3
    ,T2.ID_BENEFICIARIO AS ID_BENEFICIARIO_Q3
    ,ROW_NUMBER() OVER (PARTITION BY T2.META ORDER BY T2.META , T1.FECHA_ESTADO) AS FLAG_Q3
    ,T2.BAN_ESTADO_REG AS BAN_ESTADO_REG_Q3
FROM <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> T1
JOIN <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T2
ON (T1.NUM_DOC = (CASE WHEN T2.SK_CATEG_BENEF = 1 THEN T2.NUM_IDENT_MENOR ELSE T2.NUM_DOC END))
JOIN <%=odiRef.getObjectName("MINTIC_ESTADO_ETAPA_DIM_TB_T1")%> T3
ON (T2.SK_ETAPA = T3.SK_ETAPA)
WHERE T1.SK_ESTADO_BENEFI = 13 
AND ID_BENEFICIARIO = -1
AND T2.SK_ETAPA != -1
)
SELECT
     T1.NUM_DOC_UM_Q1 
    ,T1.MIN_Q1
    ,T1.SK_ESTADO_BENEFI_Q1
    ,T1.SK_ETAPA_Q1
    ,T1.META_Q1
    ,T1.META_ETAPA_Q1
    ,T2.TOTAL_ETAPA_UM_Q2
    ,T1.ID_BENEFICIARIO_Q1
    ,T1.BAN_ESTADO_REG_Q1
    ,(T1.META_ETAPA_Q1 - T2.TOTAL_ETAPA_UM_Q2) AS DIFERENCIA
    ,T3.NUM_DOC_UM_Q3
    ,T3.MIN_Q3
    ,T3.SK_ESTADO_BENEFI_Q3
    ,T3.SK_ETAPA_Q3
    ,T3.ID_BENEFICIARIO_Q3
    ,T3.BAN_ESTADO_REG_Q3
FROM QUERY1 T1
JOIN QUERY2 T2
ON (T1.SK_ETAPA_Q1 = T2.SK_ETAPA_Q2)
JOIN QUERY3 T3
ON (T1.META_Q1 = T3.META_Q3 AND T1.FLAG_Q1 = T3.FLAG_Q3)) T2
ON ((CASE WHEN T1.SK_CATEG_BENEF = 1 THEN T1.NUM_IDENT_MENOR ELSE T1.NUM_DOC END) = T2.NUM_DOC_UM_Q3)
WHEN MATCHED THEN
UPDATE SET T1.ID_BENEFICIARIO = T2.ID_BENEFICIARIO_Q1
,T1.BAN_ESTADO_REG = -1
WHERE /*T2.DIFERENCIA > 0
AND */T2.SK_ESTADO_BENEFI_Q3 = 13
AND T2.SK_ESTADO_BENEFI_Q1 = 9
AND T2.ID_BENEFICIARIO_Q3 = -1
AND T2.BAN_ESTADO_REG_Q1 = 5]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18133]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ORC_PARAMETROS]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[1b91f5e7-d941-4597-b1ca-42081883803b]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4532]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1359]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[120]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[ACTUALIZA LINEA DESACTIVA A DEFAULT GENERAL]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[4cd79f1e-3236-4636-aeaf-ba2a186fda17]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18133]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[MERGE INTO <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T1
USING (WITH QUERY1 AS (
SELECT
     (CASE WHEN T2.SK_CATEG_BENEF = 1 THEN T2.NUM_IDENT_MENOR ELSE T2.NUM_DOC END) AS NUM_DOC_UM_Q1
    ,T1.MIN AS MIN_Q1
    ,T1.SK_ESTADO_BENEFI AS SK_ESTADO_BENEFI_Q1
    ,T2.SK_ETAPA AS SK_ETAPA_Q1
    ,T2.META AS META_Q1
    ,T3.META_ETAPA AS META_ETAPA_Q1
    ,T2.ID_BENEFICIARIO AS ID_BENEFICIARIO_Q1
FROM <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> T1
JOIN <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T2
ON (T1.NUM_DOC = (CASE WHEN T2.SK_CATEG_BENEF = 1 THEN T2.NUM_IDENT_MENOR ELSE T2.NUM_DOC END))
JOIN <%=odiRef.getObjectName("MINTIC_ESTADO_ETAPA_DIM_TB_T1")%> T3
ON (T2.SK_ETAPA = T3.SK_ETAPA)
WHERE T1.SK_ESTADO_BENEFI = 9
AND T2.SK_ETAPA != -1
), QUERY2 AS (
SELECT
     SK_ETAPA AS SK_ETAPA_Q2
    ,COUNT(SK_ETAPA) AS TOTAL_ETAPA_UM_Q2
FROM <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%>
GROUP BY SK_ETAPA
), QUERY3 AS (
SELECT
    (CASE WHEN T2.SK_CATEG_BENEF = 1 THEN T2.NUM_IDENT_MENOR ELSE T2.NUM_DOC END) AS NUM_DOC_UM_Q3
    ,T1.MIN AS MIN_Q3
    ,T1.SK_ESTADO_BENEFI AS SK_ESTADO_BENEFI_Q3
    ,T2.SK_ETAPA AS SK_ETAPA_Q3
    ,T2.META AS META_Q3
    ,T2.ID_BENEFICIARIO AS ID_BENEFICIARIO_Q3
FROM <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> T1
JOIN <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T2
ON (T1.NUM_DOC = (CASE WHEN T2.SK_CATEG_BENEF = 1 THEN T2.NUM_IDENT_MENOR ELSE T2.NUM_DOC END))
JOIN <%=odiRef.getObjectName("MINTIC_ESTADO_ETAPA_DIM_TB_T1")%> T3
ON (T2.SK_ETAPA = T3.SK_ETAPA)
WHERE T1.SK_ESTADO_BENEFI = 13
AND ID_BENEFICIARIO NOT IN (-1)
AND T2.SK_ETAPA != -1
AND T2.BAN_ESTADO_REG = -1
)
SELECT
     T1.NUM_DOC_UM_Q1 
    ,T1.MIN_Q1
    ,T1.SK_ESTADO_BENEFI_Q1
FROM QUERY1 T1
JOIN QUERY2 T2
ON (T1.SK_ETAPA_Q1 = T2.SK_ETAPA_Q2)
JOIN QUERY3 T3
ON (T1.META_Q1 = T3.META_Q3 AND T1.ID_BENEFICIARIO_Q1 = T3.ID_BENEFICIARIO_Q3)
GROUP BY T1.NUM_DOC_UM_Q1 
    ,T1.MIN_Q1
    ,T1.SK_ESTADO_BENEFI_Q1) T2
ON ((CASE WHEN T1.SK_CATEG_BENEF = 1 THEN T1.NUM_IDENT_MENOR ELSE T1.NUM_DOC END) = T2.NUM_DOC_UM_Q1)
WHEN MATCHED THEN
UPDATE SET T1.SK_ETAPA = -1
,T1.SK_EST_LLAMADA = 35
,T1.MIN = -1
,T1.BAN_ESTADO_REG = 6
WHERE T2.SK_ESTADO_BENEFI_Q1 = 9]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18134]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ORC_PARAMETROS]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[95a1b87c-0ad2-49f9-814d-cb67afa54a00]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4533]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1359]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[130]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[ACTUALZIA ESTADO -1 A 3]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[c699a451-ab1a-45d0-935e-c6dc463cdc19]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18134]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[BEGIN
UPDATE <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%>
SET BAN_ESTADO_REG = 3
WHERE BAN_ESTADO_REG = -1;
COMMIT;
END;]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18135]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ORC_PARAMETROS]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[745b3e0d-a91c-42bf-ad07-e747a1955f44]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4534]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1359]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[10]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[ALTER SESION ]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[5144ae33-4b4b-4658-8b4f-b854c3c95ff2]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18135]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[0]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[ALTER SESSION SET NLS_DATE_FORMAT = 'DD/MM/YYYY HH24:MI:SS']]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18136]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ORC_PARAMETROS]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[2f6baf9d-78ca-4b4a-87c5-f0c40c56294f]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4535]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1359]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[50]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[ACTUALIZA ESTO ULTIMA MILLA A 5]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[15a405e2-f969-4772-8e58-860fc1ccbf31]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18136]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[MERGE INTO <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T1
USING (
SELECT
    CASE WHEN T1.SK_CATEG_BENEF = 1 THEN T1.NUM_IDENT_MENOR ELSE T1.NUM_DOC END AS NUM_DOC
FROM <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T1
JOIN <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> T4
ON (CASE WHEN T1.SK_CATEG_BENEF = 1 THEN T1.NUM_IDENT_MENOR ELSE T1.NUM_DOC END = T4.NUM_DOC)
WHERE SK_ESTADO_BENEFI IN (9)
AND BAN_ESTADO_REG = 3) T2
ON (CASE WHEN T1.SK_CATEG_BENEF = 1 THEN T1.NUM_IDENT_MENOR ELSE T1.NUM_DOC END = T2.NUM_DOC)
WHEN MATCHED THEN
UPDATE SET T1.BAN_ESTADO_REG = 5]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18137]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ORC_PARAMETROS]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[b67eaba7-2f59-4cd9-993f-2ccaa08c0cd2]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4536]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1359]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[200]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[ACTUALIZA ID BENEFICIARIO ETAPA]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[7f09d481-07f1-48fc-927e-b2d406e913fa]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18137]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[MERGE INTO <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T1
USING (
WITH QUERY1 AS (
SELECT
*
FROM (
SELECT 
     T1.ETAPA 
    ,CASE
        WHEN TOTAL_ACTIVOS IS NULL THEN 0 ELSE TOTAL_ACTIVOS END TOTAL_ACTIVOS
FROM <%=odiRef.getObjectName("MINTIC_ESTADO_ETAPA_DIM_TB_T1")%> T1
LEFT JOIN (
SELECT
     T3.ETAPA AS ETAPAS
    ,COUNT(T1.SK_ETAPA) TOTAL_ACTIVOS
FROM <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T1
JOIN <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> T2
ON (CASE
      WHEN T1.SK_CATEG_BENEF = 1 THEN T1.NUM_IDENT_MENOR ELSE T1.NUM_DOC END = T2.NUM_DOC)
JOIN MINTIC_ESTADO_ETAPA_DIM_TB_T1 T3
ON (T1.SK_ETAPA = T3.SK_ETAPA)
WHERE T2.SK_ESTADO_BENEFI IN (1)
AND BAN_ESTADO_REG = 3
GROUP BY ETAPA) T2
ON (T1.ETAPA = T2.ETAPAS)
GROUP BY ETAPA
,TOTAL_ACTIVOS)
WHERE TOTAL_ACTIVOS <> 0)
,QUERY2 AS (
SELECT 
     T1.NUM_DOC
    ,T1.FECHA_ESTADO
    ,T2.MIN
    ,T3.ETAPA
    ,T1.SK_ESTADO_BENEFI
    ,ROW_NUMBER() OVER (PARTITION BY T3.ETAPA ORDER BY T1.FECHA_ESTADO ASC) + MAX_ID_BENE AS ID_BENEFICIARIO
FROM <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> T1
JOIN <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T2
ON (T1.NUM_DOC = (CASE WHEN SK_CATEG_BENEF = 1 THEN T2. NUM_IDENT_MENOR ELSE T2.NUM_DOC END)
AND T1.MIN = T2.MIN)
JOIN <%=odiRef.getObjectName("MINTIC_ESTADO_ETAPA_DIM_TB_T1")%> T3
ON (T3.SK_ETAPA = T2.SK_ETAPA)
LEFT JOIN (SELECT
            MAX(NVL(ID_BENEFICIARIO,0)) AS MAX_ID_BENE
            ,ETAPA
      FROM <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T1
      JOIN <%=odiRef.getObjectName("MINTIC_ESTADO_ETAPA_DIM_TB_T1")%> T2
      ON (T1.SK_ETAPA = T2.SK_ETAPA)
      GROUP BY ETAPA) T4 
ON (T4.ETAPA = T3.ETAPA)
WHERE T1.SK_ESTADO_BENEFI IN (1)
AND T2.ID_BENEFICIARIO = -1
AND BAN_ESTADO_REG = 3)
,QUERY3 AS (
SELECT 
     META_X_ETAPA
    ,ETAPA
FROM <%=odiRef.getObjectName("MINTIC_ESTADO_ETAPA_DIM_TB_T1")%>
GROUP BY META_X_ETAPA
    ,ETAPA)
SELECT
     T2.ID_BENEFICIARIO
    ,T2.NUM_DOC
    ,T2.MIN
    ,T3.ETAPA
    ,T2.SK_ESTADO_BENEFI
FROM QUERY1 T1
JOIN QUERY2 T2
ON (T1.ETAPA = T2.ETAPA)
JOIN QUERY3 T3
ON (T1.ETAPA = T3.ETAPA AND T3.ETAPA = T2.ETAPA)
WHERE T2.ID_BENEFICIARIO <= T3.META_X_ETAPA) T2
ON ((CASE WHEN T1.SK_CATEG_BENEF = 1 THEN T1.NUM_IDENT_MENOR ELSE T1.NUM_DOC END) = T2.NUM_DOC)
WHEN MATCHED THEN
UPDATE SET T1.ID_BENEFICIARIO = T2.ID_BENEFICIARIO
WHERE T1.ID_BENEFICIARIO = -1
AND SK_ESTADO_BENEFI IN (1)]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18138]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ORC_PARAMETROS]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[115c790e-4599-43d3-bf58-93b87ddcfe9d]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4537]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1359]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[180]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[COMPLETA LINEAS A EN ESTDO 1]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[b9bb4a98-6dd4-4952-9cfd-b0995e950c7d]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18138]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[MERGE INTO <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> T1
USING(
SELECT
*
FROM
(
SELECT
      T3.NUM_DOC 
     ,T3.MIN
     ,T3.SK_ESTADO_BENEFI 
     ,T2.ETAPA 
     ,T2.META_X_ETAPA 
     ,ROW_NUMBER() OVER (PARTITION BY T2.ETAPA ORDER BY T3.FECHA_ESTADO) + MAX_ID AS FLAG
FROM <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T1
JOIN <%=odiRef.getObjectName("MINTIC_ESTADO_ETAPA_DIM_TB_T1")%> T2
ON (T1.SK_ETAPA = T2.SK_ETAPA)
JOIN <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> T3
ON (CASE WHEN T1.SK_CATEG_BENEF = 1 THEN T1.NUM_IDENT_MENOR ELSE T1.NUM_DOC END = T3.NUM_DOC)
LEFT JOIN (
SELECT
     T2.ETAPA
    ,MAX(ID_BENEFICIARIO) AS MAX_ID
FROM <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T1
JOIN <%=odiRef.getObjectName("MINTIC_ESTADO_ETAPA_DIM_TB_T1")%> T2
ON (T1.SK_ETAPA = T2.SK_ETAPA)
GROUP BY T2.ETAPA) T4
ON (T2.ETAPA = T4.ETAPA)
WHERE T3.SK_ESTADO_BENEFI = 13
--AND T1.BAN_ESTADO_REG = 3
)
WHERE FLAG <= META_X_ETAPA) T2
ON (T1.NUM_DOC = T2.NUM_DOC AND T1.MIN = T2.MIN)
WHEN MATCHED THEN
UPDATE SET T1.SK_ESTADO_BENEFI = 1
,FECHA_ESTADO = SYSDATE]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpLineTrt">
		<Field name="AlwaysExe" type="java.lang.String"><![CDATA[1]]></Field>
	<Field name="BrpId" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColConnectId" type="java.lang.String">null</Field>
	<Field name="ColContextCode" type="java.lang.String">null</Field>
	<Field name="ColIndCommit" type="java.lang.String">null</Field>
	<Field name="ColIsolLevel" type="java.lang.String">null</Field>
	<Field name="ColITxt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ColLanguage" type="java.lang.String">null</Field>
	<Field name="ColLschemaName" type="java.lang.String">null</Field>
	<Field name="ColTechno" type="java.lang.String">null</Field>
	<Field name="DefConnectId" type="java.lang.String">null</Field>
	<Field name="DefContextCode" type="java.lang.String">null</Field>
	<Field name="DefIndCommit" type="java.lang.String">null</Field>
	<Field name="DefIsolLevel" type="java.lang.String">null</Field>
	<Field name="DefITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18139]]></Field>
	<Field name="DefLanguage" type="java.lang.String">null</Field>
	<Field name="DefLschemaName" type="java.lang.String"><![CDATA[ORC_PARAMETROS]]></Field>
	<Field name="DefTechno" type="java.lang.String"><![CDATA[ORACLE]]></Field>
	<Field name="ExeChannel" type="java.lang.String"><![CDATA[J]]></Field>
	<Field name="FirstDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="FirstUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[f7a5caed-2e84-4356-a55b-5a68a4e181ec]]></Field>
	<Field name="IndErr" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogFinalCmd" type="java.lang.String"><![CDATA[0]]></Field>
	<Field name="IndLogNb" type="java.lang.String">null</Field>
	<Field name="ILineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[4538]]></Field>
	<Field name="IRefLineTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="IRefTrt" type="com.sunopsis.sql.DbInt"><![CDATA[null]]></Field>
	<Field name="ITrt" type="com.sunopsis.sql.DbInt"><![CDATA[1359]]></Field>
	<Field name="KcmAk" type="java.lang.String">null</Field>
	<Field name="KcmCond" type="java.lang.String">null</Field>
	<Field name="KcmErrDel" type="java.lang.String">null</Field>
	<Field name="KcmJoin" type="java.lang.String">null</Field>
	<Field name="KcmNull" type="java.lang.String">null</Field>
	<Field name="KcmPk" type="java.lang.String">null</Field>
	<Field name="KimDrvdSel" type="java.lang.String">null</Field>
	<Field name="KimIdx" type="java.lang.String">null</Field>
	<Field name="KimJrn" type="java.lang.String">null</Field>
	<Field name="KimJrnPop" type="java.lang.String">null</Field>
	<Field name="KjmCreate" type="java.lang.String">null</Field>
	<Field name="KjmDrop" type="java.lang.String">null</Field>
	<Field name="KjmExtend" type="java.lang.String">null</Field>
	<Field name="KjmInstall" type="java.lang.String">null</Field>
	<Field name="KjmLock" type="java.lang.String">null</Field>
	<Field name="KjmPurge" type="java.lang.String">null</Field>
	<Field name="KjmSetInstall" type="java.lang.String">null</Field>
	<Field name="KjmSetUninstall" type="java.lang.String">null</Field>
	<Field name="KjmSubscribe" type="java.lang.String">null</Field>
	<Field name="KjmTableOrder" type="java.lang.String">null</Field>
	<Field name="KjmUninstall" type="java.lang.String">null</Field>
	<Field name="KjmUnlock" type="java.lang.String">null</Field>
	<Field name="KjmUnsubscribe" type="java.lang.String">null</Field>
	<Field name="KlmAfterInt" type="java.lang.String">null</Field>
	<Field name="KlmIdx" type="java.lang.String">null</Field>
	<Field name="KlmJrn" type="java.lang.String">null</Field>
	<Field name="LastDate" type="java.sql.Timestamp"><![CDATA[2022-05-09 16:52:55.0]]></Field>
	<Field name="LastUser" type="java.lang.String"><![CDATA[ADMINSPA]]></Field>
	<Field name="LineType" type="java.lang.String">null</Field>
	<Field name="LogLevDet" type="java.lang.String"><![CDATA[3]]></Field>
	<Field name="MapTaskType" type="java.lang.String"><![CDATA[EM]]></Field>
	<Field name="OrdTrt" type="com.sunopsis.sql.DbInt"><![CDATA[170]]></Field>
	<Field name="SqlName" type="java.lang.String"><![CDATA[ACTUALIZA ESTO 13 A ESTADO 1]]></Field>
	<Field name="SupportedSubtypes" type="java.lang.String">null</Field>
	<Field name="VariableDefs" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpTxtHeader">
		<Field name="Enc" type="java.lang.String">null</Field>
	<Field name="EncKey" type="java.lang.String">null</Field>
 <Field name="EncKeyVect" type="java.lang.String">null</Field>
	<Field name="GlobalId" type="java.lang.String"><![CDATA[d8086d20-d0e5-40c1-8e82-8c0bd72e3417]]></Field>
	<Field name="ITxt" type="com.sunopsis.sql.DbInt"><![CDATA[18139]]></Field>
	<Field name="ITxtOrig" type="com.sunopsis.sql.DbInt"><![CDATA[102]]></Field>
	<Field name="SqlIndGrp" type="java.lang.String"><![CDATA[2]]></Field>
 <Field name="Txt" type="java.lang.String"><![CDATA[MERGE INTO <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> T1
USING(
SELECT
    T2.NUM_DOC
    ,T2.MIN
FROM <%=odiRef.getObjectName("MINTIC_INFO_BASE_BENEFI_TB")%> T1
JOIN <%=odiRef.getObjectName("MINTIC_INFO_DUPLAS_TB")%> T2
ON (CASE WHEN T1.SK_CATEG_BENEF = 1 THEN T1.NUM_IDENT_MENOR ELSE T1.NUM_DOC END = T2.NUM_DOC)
WHERE ID_BENEFICIARIO NOT IN (-1)
AND SK_ESTADO_BENEFI = 13) T2
ON (T1.NUM_DOC = T2.NUM_DOC AND T1.MIN = T2.MIN)
WHEN MATCHED THEN
UPDATE SET T1.SK_ESTADO_BENEFI = 1
,FECHA_ESTADO = SYSDATE]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_FOLDER.243]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[69305596-6e7b-4199-a1d2-56acb6e13bb8]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[PRY_FABR_DIG.008_MOVIL_REPORTE_MINTIC]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_PROJECT.SNP_FOLDER]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[12.24]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_PROJECT.84]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[efab427f-820e-49b2-b11d-10e598c79be6]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[PRY_FABR_DIG]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_PROJECT]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[12]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.18120]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[3df72453-bfef-4da6-9859-f0df048f8be1]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TRT.1359]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[9638c11f-8009-4fee-b890-d4d31dd67232]]></Field>
 <Field name="RefObjFQName" type="java.lang.String"><![CDATA[PRY_FABR_DIG.PR_008_ACTUALIZA_ESTADOS_HIST]]></Field>
 <Field name="RefObjFQType" type="java.lang.String"><![CDATA[SNP_PROJECT.SNP_TRT]]></Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String"><![CDATA[12.29]]></Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.18121]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[c720ffc0-9f7f-4068-8796-d85bea8ea90f]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_ORIGTXT.102]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String">null</Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.18122]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[e24b217d-f36c-4e42-982a-86f8932768fc]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.18123]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[7f40f868-a74b-4a15-aa38-e638a566b9a1]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.18124]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[5c8f1306-2e73-408b-8d00-331ad91d4eb2]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.18125]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[df398ed0-9a94-4179-9b8e-2a6bdd3d75ec]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.18126]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[e63dcfd7-54cb-4936-a007-dfc85bf5c993]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.18127]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[de570367-ab9a-46d8-8547-dd7a8ce65015]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.18128]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[68bdd084-2cfa-470d-a812-740e73b95e4a]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.18129]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[8db7851b-57fe-43eb-8c60-7dd3b7c04132]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.18130]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[d7b31c34-9e78-49f3-beac-cbd6da89b0ef]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.18131]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[b3b17475-f8aa-4a83-8139-f5d0fd17eac6]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.18132]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[006506a4-bad0-4f50-bcc6-ca20926e6629]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.18133]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[4cd79f1e-3236-4636-aeaf-ba2a186fda17]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.18134]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[c699a451-ab1a-45d0-935e-c6dc463cdc19]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.18135]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[5144ae33-4b4b-4658-8b4f-b854c3c95ff2]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.18136]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[15a405e2-f969-4772-8e58-860fc1ccbf31]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.18137]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[7f09d481-07f1-48fc-927e-b2d406e913fa]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.18138]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[b9bb4a98-6dd4-4952-9cfd-b0995e950c7d]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.dbobj.SnpFKXRef">
		<Field name="RefKey" type="java.lang.String"><![CDATA[SNP_TXTHEADER.18139]]></Field>
	<Field name="RefObjGlobalId" type="java.lang.String"><![CDATA[d8086d20-d0e5-40c1-8e82-8c0bd72e3417]]></Field>
 <Field name="RefObjFQName" type="java.lang.String">null</Field>
 <Field name="RefObjFQType" type="java.lang.String">null</Field>
 <Field name="RefObjFQNameLengths" type="java.lang.String">null</Field>
</Object>
<Object class="com.sunopsis.dwg.DwgExportSummary">
		<Field name="ExpTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="InstObjNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="JoinColNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="JoinNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="KeyColNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="KeyNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="LinkDiagNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="MorigTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="MtxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OrigTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="OtherObjectsNb" type="com.sunopsis.sql.DbInt"><![CDATA[21]]></Field>
	<Field name="PlanAgentNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="StepNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="TxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[20]]></Field>
	<Field name="UeOrigNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="UeUsedNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="VarPlanAgentNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="ScenTxtNb" type="com.sunopsis.sql.DbInt"><![CDATA[0]]></Field>
	<Field name="OdiVersion" type="java.lang.String"><![CDATA[12.2.1]]></Field>
	<Field name="OriginRepositoryID" type="com.sunopsis.sql.DbInt"><![CDATA[11]]></Field>
	<Field name="RepositoryVersion" type="java.lang.String"><![CDATA[05.02.02.09]]></Field>
</Object>
</SunopsisExport>
